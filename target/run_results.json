{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-17T21:25:28.363129Z", "invocation_id": "4a4c0aeb-4b0d-4ab6-8835-7727ea084e39", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:23.964380Z", "completed_at": "2025-05-17T21:25:24.001415Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.002415Z", "completed_at": "2025-05-17T21:25:24.002415Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.048043012619018555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.stg_a_la_carte_menu", "compiled": true, "compiled_code": "select\n  item_uuid,\n  item_name,\n  category,\n  `desc` as description,\n  price,\n  is_priced_per_weight\nfrom `annular-mesh-453913-r6`.`restaurant_data`.`a_la_carte_menu`", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`stg_a_la_carte_menu`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:23.975390Z", "completed_at": "2025-05-17T21:25:24.001415Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.003416Z", "completed_at": "2025-05-17T21:25:24.003416Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05004525184631348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.stg_cocktails_and_beer_menu", "compiled": true, "compiled_code": "select\n  item_uuid,\n  item_name,\n  category,\n  `desc` as description,\n  price,\n  \nfrom `annular-mesh-453913-r6`.`restaurant_data`.`cocktails_and_beer_menu`", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`stg_cocktails_and_beer_menu`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:23.978393Z", "completed_at": "2025-05-17T21:25:24.003416Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.006418Z", "completed_at": "2025-05-17T21:25:24.006418Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05104827880859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.stg_dessert_menu", "compiled": true, "compiled_code": "select\n  item_uuid,\n  item_name,\n  category,\n  `desc` as description,\n  price,\n  \nfrom `annular-mesh-453913-r6`.`restaurant_data`.`dessert_menu`", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`stg_dessert_menu`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:23.981397Z", "completed_at": "2025-05-17T21:25:24.004416Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.008420Z", "completed_at": "2025-05-17T21:25:24.008420Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05304765701293945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.stg_orders", "compiled": true, "compiled_code": "with aggregated_orders as (\n    select\n        table_no,\n        item_uuid,\n        datetime_ordered,\n        dep,\n        order_uuid,\n        count(*) as quantity\n    from `annular-mesh-453913-r6`.`restaurant_data`.`orders`\n    group by table_no, item_uuid, datetime_ordered, dep, order_uuid\n)\n\nselect\n    to_hex(md5(cast(coalesce(cast(table_no as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(item_uuid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(datetime_ordered as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dep as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(order_uuid as string), '_dbt_utils_surrogate_key_null_') as string))) as item_ordered_id,\n    table_no,\n    item_uuid,\n    datetime_ordered,\n    dep as production_department,\n    order_uuid,\n    quantity\nfrom aggregated_orders", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`stg_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.022433Z", "completed_at": "2025-05-17T21:25:24.051458Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.052459Z", "completed_at": "2025-05-17T21:25:24.052459Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.039034366607666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.stg_wine_menu", "compiled": true, "compiled_code": "select\n  item_uuid,\n  item_name,\n  category,\n  origin_region,\n  origin_country,\n  serving_size,\n  price\nfrom `annular-mesh-453913-r6`.`restaurant_data`.`wine_menu`", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`stg_wine_menu`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.025435Z", "completed_at": "2025-05-17T21:25:24.052459Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.053460Z", "completed_at": "2025-05-17T21:25:24.053460Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.041036128997802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_stg_a_la_carte_menu_category.37817551cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom `annular-mesh-453913-r6`.`dbt_`.`stg_a_la_carte_menu`\nwhere category is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.040449Z", "completed_at": "2025-05-17T21:25:24.053460Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.057465Z", "completed_at": "2025-05-17T21:25:24.057465Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04404115676879883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_stg_a_la_carte_menu_item_name.36ae67ce39", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_name\nfrom `annular-mesh-453913-r6`.`dbt_`.`stg_a_la_carte_menu`\nwhere item_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.046454Z", "completed_at": "2025-05-17T21:25:24.054461Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.059466Z", "completed_at": "2025-05-17T21:25:24.059466Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04504084587097168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_stg_a_la_carte_menu_item_uuid.bc2025dfa2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_uuid\nfrom `annular-mesh-453913-r6`.`dbt_`.`stg_a_la_carte_menu`\nwhere item_uuid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.071477Z", "completed_at": "2025-05-17T21:25:24.089495Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.095500Z", "completed_at": "2025-05-17T21:25:24.095500Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03403115272521973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_stg_a_la_carte_menu_item_uuid.a16abef12e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select item_uuid as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`stg_a_la_carte_menu`\n  where item_uuid is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.079486Z", "completed_at": "2025-05-17T21:25:24.094498Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.096500Z", "completed_at": "2025-05-17T21:25:24.096500Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03503084182739258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_stg_cocktails_and_beer_menu_category.59e7e90b4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom `annular-mesh-453913-r6`.`dbt_`.`stg_cocktails_and_beer_menu`\nwhere category is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.085491Z", "completed_at": "2025-05-17T21:25:24.096500Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.098502Z", "completed_at": "2025-05-17T21:25:24.098502Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03503298759460449, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_stg_cocktails_and_beer_menu_item_name.b14f64b4a7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_name\nfrom `annular-mesh-453913-r6`.`dbt_`.`stg_cocktails_and_beer_menu`\nwhere item_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.090494Z", "completed_at": "2025-05-17T21:25:24.097501Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.102506Z", "completed_at": "2025-05-17T21:25:24.102506Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03814387321472168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_stg_cocktails_and_beer_menu_item_uuid.69972c6fe3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_uuid\nfrom `annular-mesh-453913-r6`.`dbt_`.`stg_cocktails_and_beer_menu`\nwhere item_uuid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.115628Z", "completed_at": "2025-05-17T21:25:24.132780Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.138785Z", "completed_at": "2025-05-17T21:25:24.138785Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03316855430603027, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_stg_cocktails_and_beer_menu_item_uuid.1036d05d9f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select item_uuid as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`stg_cocktails_and_beer_menu`\n  where item_uuid is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.120768Z", "completed_at": "2025-05-17T21:25:24.137784Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.139788Z", "completed_at": "2025-05-17T21:25:24.139788Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0341646671295166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_stg_dessert_menu_category.84e31519c2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom `annular-mesh-453913-r6`.`dbt_`.`stg_dessert_menu`\nwhere category is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.124772Z", "completed_at": "2025-05-17T21:25:24.138785Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.140787Z", "completed_at": "2025-05-17T21:25:24.140787Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03617429733276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_stg_dessert_menu_item_name.bc9a182538", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_name\nfrom `annular-mesh-453913-r6`.`dbt_`.`stg_dessert_menu`\nwhere item_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.132780Z", "completed_at": "2025-05-17T21:25:24.140787Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.145791Z", "completed_at": "2025-05-17T21:25:24.145791Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.036173343658447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_stg_dessert_menu_item_uuid.5100194b40", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_uuid\nfrom `annular-mesh-453913-r6`.`dbt_`.`stg_dessert_menu`\nwhere item_uuid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.156805Z", "completed_at": "2025-05-17T21:25:24.175912Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.177914Z", "completed_at": "2025-05-17T21:25:24.177914Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02911520004272461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_stg_dessert_menu_item_uuid.a3fb86a75b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select item_uuid as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`stg_dessert_menu`\n  where item_uuid is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.161810Z", "completed_at": "2025-05-17T21:25:24.176913Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.178915Z", "completed_at": "2025-05-17T21:25:24.178915Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03211784362792969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_stg_orders_item_ordered_id.abffa82b2b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_ordered_id\nfrom `annular-mesh-453913-r6`.`dbt_`.`stg_orders`\nwhere item_ordered_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.166815Z", "completed_at": "2025-05-17T21:25:24.178915Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.181917Z", "completed_at": "2025-05-17T21:25:24.181917Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.033123016357421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_stg_orders_item_uuid.954a22771b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_uuid\nfrom `annular-mesh-453913-r6`.`dbt_`.`stg_orders`\nwhere item_uuid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.171908Z", "completed_at": "2025-05-17T21:25:24.179916Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.184920Z", "completed_at": "2025-05-17T21:25:24.184920Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03512144088745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_stg_orders_item_ordered_id.371219fd6d", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select item_ordered_id as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`stg_orders`\n  where item_ordered_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.196932Z", "completed_at": "2025-05-17T21:25:24.217951Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.218952Z", "completed_at": "2025-05-17T21:25:24.218952Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031028032302856445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.dim_menu_items", "compiled": true, "compiled_code": "with a_la_carte as (\n    select\n        item_uuid,\n        item_name,\n        category,\n        description,  \n        coalesce(safe_cast(price as float64), 0.0) as price,\n        is_priced_per_weight,\n        ' ' as origin_region,\n        ' ' as origin_country,\n        null as serving_size,\n        'a_la_carte' as menu_source\n    from `annular-mesh-453913-r6`.`dbt_`.`stg_a_la_carte_menu`\n),\ncocktails_and_beer as (\n    select\n        item_uuid,\n        item_name,\n        category,\n        description,\n        coalesce(safe_cast(price as float64), 0.0) as price,\n        false as is_priced_per_weight,\n        ' ' as origin_region,\n        ' ' as origin_country,\n        null as serving_size,\n        'cocktails_and_beer' as menu_source\n    from `annular-mesh-453913-r6`.`dbt_`.`stg_cocktails_and_beer_menu`\n),\ndessert as (\n    select\n        item_uuid,\n        item_name,\n        category,\n        description,\n        coalesce(safe_cast(price as float64), 0.0) as price,\n        false as is_priced_per_weight,\n        ' ' as origin_region,\n        ' ' as origin_country,\n        null as serving_size,\n        'dessert' as menu_source\n    from `annular-mesh-453913-r6`.`dbt_`.`stg_dessert_menu`\n),\nwine as (\n    select\n        item_uuid,\n        item_name,\n        category,\n        ' ' as description,   \n        coalesce(safe_cast(price as float64), 0.0) as price,\n        false  as is_priced_per_weight,\n        origin_region,\n        origin_country,\n        serving_size,         \n        'wine' as menu_source\n    from `annular-mesh-453913-r6`.`dbt_`.`stg_wine_menu`\n)\n\nselect *\nfrom a_la_carte\n\nunion all\n\nselect *\nfrom cocktails_and_beer\n\nunion all\n\nselect *\nfrom dessert\n\nunion all\n\nselect *\nfrom wine", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.200934Z", "completed_at": "2025-05-17T21:25:24.217951Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.219953Z", "completed_at": "2025-05-17T21:25:24.219953Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03302884101867676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_stg_wine_menu_category.dea98b2bd0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom `annular-mesh-453913-r6`.`dbt_`.`stg_wine_menu`\nwhere category is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.205939Z", "completed_at": "2025-05-17T21:25:24.218952Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.222955Z", "completed_at": "2025-05-17T21:25:24.222955Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03503274917602539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_stg_wine_menu_item_name.275c234874", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_name\nfrom `annular-mesh-453913-r6`.`dbt_`.`stg_wine_menu`\nwhere item_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.212945Z", "completed_at": "2025-05-17T21:25:24.220953Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.224957Z", "completed_at": "2025-05-17T21:25:24.224957Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.035031795501708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_stg_wine_menu_item_uuid.141c870ced", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_uuid\nfrom `annular-mesh-453913-r6`.`dbt_`.`stg_wine_menu`\nwhere item_uuid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.236968Z", "completed_at": "2025-05-17T21:25:24.275003Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.277004Z", "completed_at": "2025-05-17T21:25:24.277004Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.049045562744140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_stg_wine_menu_item_uuid.ddca70a303", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select item_uuid as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`stg_wine_menu`\n  where item_uuid is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.242972Z", "completed_at": "2025-05-17T21:25:24.277004Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.279005Z", "completed_at": "2025-05-17T21:25:24.279005Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05004525184631348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.fct_orders", "compiled": true, "compiled_code": "with base_orders as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`stg_orders`\n),\n\nmenu_lookup as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\n)\n\nselect\n    o.item_ordered_id,\n    o.table_no,\n    o.item_uuid,\n    o.datetime_ordered,\n    o.production_department,\n    o.order_uuid,\n    o.quantity,\n\n    -- Date/time breakdown\n    date(o.datetime_ordered) as order_date,\n    extract(hour from o.datetime_ordered) as order_hour,\n    format_date('%A', date(o.datetime_ordered)) as order_weekday,\n\n    -- Menu info\n    m.item_name,\n    m.category,\n    m.price,\n    m.menu_source,\n\n    -- Revenue\n    o.quantity * m.price as total_item_revenue\n\nfrom base_orders o\nleft join menu_lookup m\n  on o.item_uuid = m.item_uuid", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`fct_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.246976Z", "completed_at": "2025-05-17T21:25:24.278005Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.282009Z", "completed_at": "2025-05-17T21:25:24.282009Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05204892158508301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_dim_menu_items_category__Bordeaux__Champagne_Sparkling__Dessert_Wines__Port_Sherry__Rarities__Red_Wines__Rose_Wines__White_Wines__Cheese__The_Sacred_Six__Ultimate_Steakhouse_Cocktails__Time_A_Place__Lo_No_Alc__Beers_Cider__Starters__Mains__Large_Cuts__Steaks__Sauces__Extras__Sides__Burgundy__Magnums__Puddings__Ice_Cream_Sorbet__Chocolates.cf6c12d38a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        category as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\n    group by category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Bordeaux','Champagne & Sparkling','Dessert Wines','Port & Sherry','Rarities','Red Wines','Rose Wines','White Wines','Cheese','The Sacred Six','Ultimate Steakhouse Cocktails','Time & A Place','Lo & No Alc','Beers & Cider','Starters','Mains','Large Cuts','Steaks','Sauces','Extras','Sides','Burgundy','Magnums','Puddings','Ice-Cream & Sorbet','Chocolates'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.270999Z", "completed_at": "2025-05-17T21:25:24.279005Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.284011Z", "completed_at": "2025-05-17T21:25:24.284011Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05304765701293945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_dim_menu_items_category.69523848c3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\nwhere category is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.297022Z", "completed_at": "2025-05-17T21:25:24.318042Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.319044Z", "completed_at": "2025-05-17T21:25:24.319044Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03202986717224121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_dim_menu_items_is_priced_per_weight.d487175596", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_priced_per_weight\nfrom `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\nwhere is_priced_per_weight is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.303027Z", "completed_at": "2025-05-17T21:25:24.320043Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.321044Z", "completed_at": "2025-05-17T21:25:24.321044Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0320277214050293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_dim_menu_items_item_name.5271b11418", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_name\nfrom `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\nwhere item_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.309033Z", "completed_at": "2025-05-17T21:25:24.320043Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.324047Z", "completed_at": "2025-05-17T21:25:24.324047Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03503274917602539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_dim_menu_items_item_uuid.774c582c18", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_uuid\nfrom `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\nwhere item_uuid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.314038Z", "completed_at": "2025-05-17T21:25:24.323046Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.327051Z", "completed_at": "2025-05-17T21:25:24.327051Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0370333194732666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_dim_menu_items_menu_source.e5d551a7f0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect menu_source\nfrom `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\nwhere menu_source is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.336057Z", "completed_at": "2025-05-17T21:25:24.350070Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.358079Z", "completed_at": "2025-05-17T21:25:24.358079Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0370335578918457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_dim_menu_items_price.1ac5d639c4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price\nfrom `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\nwhere price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.343064Z", "completed_at": "2025-05-17T21:25:24.363082Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.367087Z", "completed_at": "2025-05-17T21:25:24.367087Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03603029251098633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.relationships_stg_orders_item_uuid__item_uuid__ref_dim_menu_items_.b2c69889e6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select item_uuid as from_field\n    from `annular-mesh-453913-r6`.`dbt_`.`stg_orders`\n    where item_uuid is not null\n),\n\nparent as (\n    select item_uuid as to_field\n    from `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.354074Z", "completed_at": "2025-05-17T21:25:24.366085Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.368086Z", "completed_at": "2025-05-17T21:25:24.368086Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03303027153015137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_dim_menu_items_item_uuid.bd08cb1ca7", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select item_uuid as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\n  where item_uuid is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.359079Z", "completed_at": "2025-05-17T21:25:24.367087Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.370089Z", "completed_at": "2025-05-17T21:25:24.370089Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03402972221374512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_category_performance", "compiled": true, "compiled_code": "with enriched_orders as (\n    select\n        o.item_uuid,\n        o.quantity,\n        o.total_item_revenue,\n        m.category,\n        m.menu_source,\n        m.price,\n        date(o.datetime_ordered) as order_date\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders` o\n    join `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items` m using (item_uuid)\n),\n\ncategory_metrics as (\n    select\n        category,\n        menu_source,\n        sum(quantity) as total_units_sold,\n        sum(total_item_revenue) as total_revenue,\n        avg(price) as avg_price,\n        round(sum(total_item_revenue) / nullif(sum(quantity), 0), 2) as avg_price_per_unit\n    from enriched_orders\n    group by category, menu_source\n),\n\ncategory_metrics_last_30_days as (\n    select\n        category,\n        menu_source,\n        sum(quantity) as total_units_sold_30d,\n        sum(total_item_revenue) as total_revenue_30d\n    from enriched_orders\n    where order_date >= current_date - interval 30 day\n    group by category, menu_source\n),\n\ncategory_metrics_last_7_days as (\n    select\n        category,\n        menu_source,\n        sum(quantity) as total_units_sold_7d,\n        sum(total_item_revenue) as total_revenue_7d\n    from enriched_orders\n    where order_date >= current_date - interval 7 day\n    group by category, menu_source\n)\n\nselect\n    cm.*,\n    coalesce(cm30.total_units_sold_30d, 0) as total_units_sold_30d,\n    coalesce(cm30.total_revenue_30d, 0.0) as total_revenue_30d,\n    coalesce(cm7.total_units_sold_7d, 0) as total_units_sold_7d,\n    coalesce(cm7.total_revenue_7d, 0.0) as total_revenue_7d\nfrom category_metrics cm\nleft join category_metrics_last_30_days cm30 using (category, menu_source)\nleft join category_metrics_last_7_days cm7 using (category, menu_source)\norder by cm.total_revenue desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_category_performance`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.380097Z", "completed_at": "2025-05-17T21:25:24.386103Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.399115Z", "completed_at": "2025-05-17T21:25:24.399115Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03202962875366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_customer_counts", "compiled": true, "compiled_code": "with base as (\n    select\n        datetime_trunc(datetime_ordered, hour) as order_hour_dt,\n        date(datetime_ordered) as order_date,\n        category\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n    where production_department = 'kitchen'\n),\n\nhourly as (\n    select\n        order_hour_dt,\n        order_date,\n        count(*) as total_mains_ordered_per_hour\n    from base\n    where category in ('Mains', 'Large Cuts', 'Steaks')\n    group by order_hour_dt, order_date\n)\n\nselect\n    order_hour_dt,\n    order_date,\n    total_mains_ordered_per_hour\n    \nfrom hourly", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_customer_counts`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.386103Z", "completed_at": "2025-05-17T21:25:24.400117Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.401117Z", "completed_at": "2025-05-17T21:25:24.401117Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.028024673461914062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_daily_metadata", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        order_date,\n        item_uuid,\n        category,\n        production_department,\n        table_no\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n),\n\ndaily_table_stats  as (\n    select\n        order_date,\n        count(distinct table_no) as distinct_tables_used_all_day\n    from base\n    group by order_date\n),\n\ndaily_food_stats  as (\n    select\n        order_date,\n        count(distinct category) as food_category_diversity_all_day,\n        count(distinct table_no) as food_tables_used_all_day,\n        count(distinct item_uuid) as unique_food_items_ordered_all_day\n    from base\n    where production_department = 'kitchen'\n    group by order_date\n),\n\ndaily_drink_stats  as (\n    select\n        order_date,\n        count(distinct category) as drink_category_diversity_all_day,\n        count(distinct table_no) as drink_tables_used_all_day,\n        count(distinct item_uuid) as unique_drink_items_ordered_all_day\n    from base\n    where production_department = 'bar'\n    group by order_date\n)\n\nselect\n    dts.order_date,\n    dts.distinct_tables_used_all_day,\n    coalesce(dfs.food_category_diversity_all_day, 0) as food_category_diversity_all_day,\n    coalesce(dfs.food_tables_used_all_day, 0) as distinct_food_tables_used_all_day,\n    coalesce(dfs.unique_food_items_ordered_all_day, 0) as unique_food_items_ordered_all_day,\n    coalesce(dds.drink_category_diversity_all_day, 0) as drink_category_diversity_all_day,\n    coalesce(dds.drink_tables_used_all_day, 0) as distinct_drink_tables_used_all_day,\n    coalesce(dds.unique_drink_items_ordered_all_day, 0) as unique_drink_items_ordered_all_day\nfrom daily_table_stats dts\nleft join daily_food_stats dfs using (order_date)\nleft join daily_drink_stats dds using (order_date)\norder by order_date desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_daily_metadata`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.390106Z", "completed_at": "2025-05-17T21:25:24.401117Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.404120Z", "completed_at": "2025-05-17T21:25:24.404120Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02702474594116211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_item_performance_mo", "compiled": true, "compiled_code": "with base as (\n    select *, format_date('%Y-%m', order_date) as order_month\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n),\n\nmenu as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\n),\n\nrevenue_totals as (\n    select\n        order_month,\n        sum(total_item_revenue) as total_revenue_all\n    from base\n    group by order_month\n),\n\naggregated_items as (\n    select\n        o.item_uuid,\n        m.item_name,\n        m.category as item_category,\n        m.menu_source,\n        m.price as item_price,\n        o.order_month,\n\n        sum(o.quantity) as total_units_sold,\n        sum(o.total_item_revenue) as total_revenue,\n\n        round(avg(extract(hour from o.datetime_ordered)), 2) as avg_order_hour,\n        round(sum(o.total_item_revenue) / t.total_revenue_all, 4) as percent_of_total_sales,\n        round(sum(o.total_item_revenue) / nullif(sum(o.quantity), 0), 2) as avg_price_per_unit,\n\n        case\n            when sum(o.quantity) < 10 or (sum(o.total_item_revenue) / t.total_revenue_all) < 0.01\n              then true else false\n        end as is_underperformer,\n\n        case\n            when (sum(o.total_item_revenue) / t.total_revenue_all) > 0.10\n              then true else false\n        end as is_top_seller,\n\n        case\n            when sum(o.quantity) < 10 and (sum(o.total_item_revenue) / t.total_revenue_all) < 0.01\n              then 'Low units & low revenue share'\n            when sum(o.quantity) < 10 then 'Low units sold'\n            when (sum(o.total_item_revenue) / t.total_revenue_all) < 0.01 then 'Low revenue share'\n            else null\n        end as underperformance_reason,\n\n        case\n            when (sum(o.total_item_revenue) / t.total_revenue_all) > 0.10 then 'Top Seller'\n            when sum(o.quantity) < 10 or (sum(o.total_item_revenue) / t.total_revenue_all) < 0.01 then 'Underperformer'\n            else 'Standard Performer'\n        end as performance_tier,\n\n        dense_rank() over (partition by o.order_month order by sum(o.total_item_revenue) desc) as item_revenue_rank\n\n    from base o\n    left join menu m on o.item_uuid = m.item_uuid\n    left join revenue_totals t on o.order_month = t.order_month\n    group by\n        o.item_uuid, m.item_name, m.category, m.menu_source, m.price, o.order_month, t.total_revenue_all\n)\n\nselect *,\n       current_timestamp() as report_generated_at\nfrom aggregated_items\norder by order_month, total_revenue desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_mo`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.395112Z", "completed_at": "2025-05-17T21:25:24.402118Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.406122Z", "completed_at": "2025-05-17T21:25:24.406122Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.029025793075561523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_item_performance_total", "compiled": true, "compiled_code": "with base as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n),\n\nmenu as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\n),\n\nrevenue_totals as (\n    select\n        sum(total_item_revenue) as total_revenue_all\n    from base\n),\n\naggregated_items as (\n    select\n        o.item_uuid,\n        m.item_name,\n        m.category as item_category,\n        m.menu_source,\n        m.price as item_price,\n\n        sum(o.quantity) as total_units_sold,\n        sum(o.total_item_revenue) as total_revenue,\n\n        round(avg(extract(hour from o.datetime_ordered)), 2) as avg_order_hour,\n        round(sum(o.total_item_revenue) / t.total_revenue_all, 4) as percent_of_total_sales,\n        round(sum(o.total_item_revenue) / nullif(sum(o.quantity), 0), 2) as avg_price_per_unit,\n\n        -- Performance flags\n        case\n            when sum(o.quantity) < 10 or (sum(o.total_item_revenue) / t.total_revenue_all) < 0.01\n              then true else false\n        end as is_underperformer,\n\n        case\n            when (sum(o.total_item_revenue) / t.total_revenue_all) > 0.10\n              then true else false\n        end as is_top_seller,\n\n        case\n            when sum(o.quantity) < 10 and (sum(o.total_item_revenue) / t.total_revenue_all) < 0.01\n              then 'Low units & low revenue share'\n            when sum(o.quantity) < 10\n              then 'Low units sold'\n            when (sum(o.total_item_revenue) / t.total_revenue_all) < 0.01\n              then 'Low revenue share'\n            else null\n        end as underperformance_reason,\n\n        case\n            when (sum(o.total_item_revenue) / t.total_revenue_all) > 0.10 then 'Top Seller'\n            when sum(o.quantity) < 10 or (sum(o.total_item_revenue) / t.total_revenue_all) < 0.01 then 'Underperformer'\n            else 'Standard Performer'\n        end as performance_tier,\n\n        dense_rank() over (order by sum(o.total_item_revenue) desc) as item_revenue_rank\n\n    from base o\n    left join menu m on o.item_uuid = m.item_uuid\n    cross join revenue_totals t\n    group by\n        o.item_uuid, m.item_name, m.category, m.menu_source, m.price, t.total_revenue_all\n)\n\nselect *,\n       current_timestamp() as report_generated_at\nfrom aggregated_items\norder by total_revenue desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_total`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.418133Z", "completed_at": "2025-05-17T21:25:24.434147Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.436149Z", "completed_at": "2025-05-17T21:25:24.436149Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02802562713623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_item_performance_wk", "compiled": true, "compiled_code": "with base as (\n    select *, format_date('%G-%V', order_date) as order_week\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n),\n\nmenu as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\n),\n\nrevenue_totals as (\n    select\n        order_week,\n        sum(total_item_revenue) as total_revenue_all\n    from base\n    group by order_week\n),\n\naggregated_items as (\n    select\n        o.item_uuid,\n        m.item_name,\n        m.category as item_category,\n        m.menu_source,\n        m.price as item_price,\n        o.order_week,\n\n        sum(o.quantity) as total_units_sold,\n        sum(o.total_item_revenue) as total_revenue,\n\n        round(avg(extract(hour from o.datetime_ordered)), 2) as avg_order_hour,\n        round(sum(o.total_item_revenue) / t.total_revenue_all, 4) as percent_of_total_sales,\n        round(sum(o.total_item_revenue) / nullif(sum(o.quantity), 0), 2) as avg_price_per_unit,\n\n        case\n            when sum(o.quantity) < 10 or (sum(o.total_item_revenue) / t.total_revenue_all) < 0.01\n              then true else false\n        end as is_underperformer,\n\n        case\n            when (sum(o.total_item_revenue) / t.total_revenue_all) > 0.10\n              then true else false\n        end as is_top_seller,\n\n        case\n            when sum(o.quantity) < 10 and (sum(o.total_item_revenue) / t.total_revenue_all) < 0.01\n              then 'Low units & low revenue share'\n            when sum(o.quantity) < 10 then 'Low units sold'\n            when (sum(o.total_item_revenue) / t.total_revenue_all) < 0.01 then 'Low revenue share'\n            else null\n        end as underperformance_reason,\n\n        case\n            when (sum(o.total_item_revenue) / t.total_revenue_all) > 0.10 then 'Top Seller'\n            when sum(o.quantity) < 10 or (sum(o.total_item_revenue) / t.total_revenue_all) < 0.01 then 'Underperformer'\n            else 'Standard Performer'\n        end as performance_tier,\n\n        dense_rank() over (partition by o.order_week order by sum(o.total_item_revenue) desc) as item_revenue_rank\n\n    from base o\n    left join menu m on o.item_uuid = m.item_uuid\n    left join revenue_totals t on o.order_week = t.order_week\n    group by\n        o.item_uuid, m.item_name, m.category, m.menu_source, m.price, o.order_week, t.total_revenue_all\n)\n\nselect *,\n       current_timestamp() as report_generated_at\nfrom aggregated_items\norder by order_week, total_revenue desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_wk`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.423137Z", "completed_at": "2025-05-17T21:25:24.436149Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.438151Z", "completed_at": "2025-05-17T21:25:24.438151Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.028023481369018555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_monthly_metadata", "compiled": true, "compiled_code": "\n\nwith base as (\n    select\n        format_date('%Y-%m', order_date) as order_month,\n        order_date,\n        item_uuid,\n        category,\n        production_department\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n),\n\nunique_items_ordered as (\n    select\n        order_month,\n        count(distinct item_uuid) as unique_items_ordered_all_month\n    from base\n    group by order_month\n),\n\nmonthly_food_stats as (\n    select\n        order_month,\n        count(distinct category) as food_category_diversity_all_month,\n        count(distinct item_uuid) as unique_food_items_ordered_all_month\n    from base\n    where production_department = 'kitchen'\n    group by order_month\n),\n\nmonthly_drink_stats as (\n    select\n        order_month,\n        count(distinct category) as drink_category_diversity_all_month,\n        count(distinct item_uuid) as unique_drink_items_ordered_all_month\n    from base\n    where production_department = 'bar'\n    group by order_month\n),\n\nweekend_counts as (\n    select\n        format_date('%Y-%m', order_date) as order_month,\n        count(distinct order_date) as weekend_days_in_month\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n    where extract(dayofweek from order_date) in (1, 6, 7)  -- Sunday = 1, Friday = 6, Saturday = 7\n    group by order_month\n)\n\nselect\n    uio.order_month,\n    uio.unique_items_ordered_all_month,\n    fds.food_category_diversity_all_month,\n    fds.unique_food_items_ordered_all_month,\n    dds.drink_category_diversity_all_month,\n    dds.unique_drink_items_ordered_all_month,\n    wc.weekend_days_in_month\nfrom unique_items_ordered uio\nleft join monthly_food_stats fds using (order_month)\nleft join monthly_drink_stats dds using (order_month)\nleft join weekend_counts wc using (order_month)\norder by uio.order_month desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_monthly_metadata`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.427141Z", "completed_at": "2025-05-17T21:25:24.437150Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.439152Z", "completed_at": "2025-05-17T21:25:24.439152Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.030026912689208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_weekly_metadata", "compiled": true, "compiled_code": "\n\n-- Base table extracting order week, item, category, and department\nwith base as (\n    select\n        format_date('%G-%V', order_date) as order_week,\n        item_uuid,\n        category,\n        production_department\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n),\n\n-- Count of unique food items ordered per week (kitchen only)\nunique_food_items_ordered as (\n    select\n        order_week,\n        count(distinct item_uuid) as unique_food_items_ordered_all_week\n    from base\n    where production_department = 'kitchen'\n    group by order_week\n),\n\n-- Count of unique drink items ordered per week (bar only)\nunique_drink_items_ordered as (\n    select\n        order_week,\n        count(distinct item_uuid) as unique_drink_items_ordered_all_week\n    from base\n    where production_department = 'bar'\n    group by order_week\n),\n\n-- Count of unique food categories per week\nweekly_food_category_diversity as (\n    select\n        order_week,\n        count(distinct category) as food_category_diversity_all_week\n    from base\n    where production_department = 'kitchen'\n    group by order_week\n),\n\n-- Count of unique drink categories per week\nweekly_drink_category_diversity as (\n    select\n        order_week,\n        count(distinct category) as drink_category_diversity_all_week\n    from base\n    where production_department = 'bar'\n    group by order_week\n)\n\nselect\n    fio.order_week,\n    fio.unique_food_items_ordered_all_week,\n    dio.unique_drink_items_ordered_all_week,\n    fcd.food_category_diversity_all_week,\n    dcd.drink_category_diversity_all_week\nfrom unique_food_items_ordered fio\n-- Using INNER JOIN here because we assume every week has both food and drink orders,\n-- so there will always be matching order_week values in both tables.\ninner join unique_drink_items_ordered dio using (order_week)\n-- LEFT JOINs used for category diversity tables in case any week is missing categories\nleft join weekly_food_category_diversity fcd using (order_week)\nleft join weekly_drink_category_diversity dcd using (order_week)\norder by order_week desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_weekly_metadata`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.431146Z", "completed_at": "2025-05-17T21:25:24.437150Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.441153Z", "completed_at": "2025-05-17T21:25:24.441153Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.031028032302856445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.dim_time", "compiled": true, "compiled_code": "with base as (\n    select distinct datetime_ordered\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n)\n\nselect\n    datetime_ordered,\n    date(datetime_ordered) as order_date,\n    extract(hour from datetime_ordered) as order_hour,\n    extract(minute from datetime_ordered) as order_minute,\n    format_date('%A', date(datetime_ordered)) as order_weekday,\n    extract(dayofweek from datetime_ordered) as order_dayofweek,  \n    extract(month from datetime_ordered) as order_month_num,\n    format_date('%B', date(datetime_ordered)) as order_month,\n    extract(year from datetime_ordered) as order_year,\n\n    -- Weekend flag: Friday (6), Saturday (7), Sunday (1)\n    case\n        when extract(dayofweek from datetime_ordered) in (1, 6, 7) then true\n        else false\n    end as is_weekend\n\nfrom base", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`dim_time`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.454165Z", "completed_at": "2025-05-17T21:25:24.488196Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.490199Z", "completed_at": "2025-05-17T21:25:24.490199Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04404139518737793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_fct_orders_menu_source__a_la_carte__wine__dessert__cocktails_and_beer.f09ddd97a4", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        menu_source as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n    group by menu_source\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'a_la_carte','wine','dessert','cocktails_and_beer'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.463173Z", "completed_at": "2025-05-17T21:25:24.490199Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.492199Z", "completed_at": "2025-05-17T21:25:24.492199Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.047041893005371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_fct_orders_order_weekday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday__Sunday.14d53fa665", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        order_weekday as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n    group by order_weekday\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.472181Z", "completed_at": "2025-05-17T21:25:24.491199Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.495203Z", "completed_at": "2025-05-17T21:25:24.495203Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0470433235168457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_fct_orders_production_department__kitchen__bar.60bb7e44ff", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        production_department as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n    group by production_department\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'kitchen','bar'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.479188Z", "completed_at": "2025-05-17T21:25:24.491199Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.496203Z", "completed_at": "2025-05-17T21:25:24.496203Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05004453659057617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_fct_orders_order_hour__23__0.3dddbd9d13", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not order_hour >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not order_hour <= 23\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.508215Z", "completed_at": "2025-05-17T21:25:24.528233Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.530235Z", "completed_at": "2025-05-17T21:25:24.530235Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030028343200683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_fct_orders_quantity__50__1.2dc70d2c12", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not quantity >= 1\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not quantity <= 50\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.514220Z", "completed_at": "2025-05-17T21:25:24.529233Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.531236Z", "completed_at": "2025-05-17T21:25:24.531236Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.031027555465698242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_category.0a620c476d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere category is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.519224Z", "completed_at": "2025-05-17T21:25:24.531236Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.536240Z", "completed_at": "2025-05-17T21:25:24.536240Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03403186798095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_datetime_ordered.aacf1c2eea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect datetime_ordered\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere datetime_ordered is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.524228Z", "completed_at": "2025-05-17T21:25:24.531236Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.537242Z", "completed_at": "2025-05-17T21:25:24.537242Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.034030914306640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_item_name.b425bb9ffe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_name\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere item_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.547250Z", "completed_at": "2025-05-17T21:25:24.568269Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.571271Z", "completed_at": "2025-05-17T21:25:24.571271Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0320286750793457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_item_ordered_id.1a48e4de0a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_ordered_id\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere item_ordered_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.552254Z", "completed_at": "2025-05-17T21:25:24.569270Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.571271Z", "completed_at": "2025-05-17T21:25:24.571271Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03403115272521973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_item_uuid.145ea3a0c1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_uuid\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere item_uuid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.558260Z", "completed_at": "2025-05-17T21:25:24.570270Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.572272Z", "completed_at": "2025-05-17T21:25:24.572272Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.035033464431762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_menu_source.ab9cf8e7bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect menu_source\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere menu_source is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.563264Z", "completed_at": "2025-05-17T21:25:24.572272Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.578278Z", "completed_at": "2025-05-17T21:25:24.578278Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03603219985961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_order_date.84f0a76362", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_date\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere order_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.590289Z", "completed_at": "2025-05-17T21:25:24.606303Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.611309Z", "completed_at": "2025-05-17T21:25:24.611309Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.032030582427978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_order_hour.385ba97c83", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_hour\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere order_hour is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.595295Z", "completed_at": "2025-05-17T21:25:24.611309Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.613311Z", "completed_at": "2025-05-17T21:25:24.613311Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.032029151916503906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_order_uuid.9e38b191ab", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_uuid\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere order_uuid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.601299Z", "completed_at": "2025-05-17T21:25:24.612310Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.615312Z", "completed_at": "2025-05-17T21:25:24.615312Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.033028364181518555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_order_weekday.d374011ab1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_weekday\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere order_weekday is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.606303Z", "completed_at": "2025-05-17T21:25:24.614310Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.619315Z", "completed_at": "2025-05-17T21:25:24.619315Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.035030364990234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_price.5983e7e539", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.630326Z", "completed_at": "2025-05-17T21:25:24.651344Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.653347Z", "completed_at": "2025-05-17T21:25:24.653347Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.032028913497924805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_production_department.6b5c746240", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect production_department\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere production_department is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.635329Z", "completed_at": "2025-05-17T21:25:24.652346Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.654347Z", "completed_at": "2025-05-17T21:25:24.654347Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.033028602600097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_quantity.f754434156", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.640335Z", "completed_at": "2025-05-17T21:25:24.652346Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.654347Z", "completed_at": "2025-05-17T21:25:24.654347Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03403067588806152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_table_no.d78c6ee39c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect table_no\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere table_no is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.645339Z", "completed_at": "2025-05-17T21:25:24.654347Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.659352Z", "completed_at": "2025-05-17T21:25:24.659352Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.036032915115356445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_fct_orders_total_item_revenue.eb686692f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_item_revenue\nfrom `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\nwhere total_item_revenue is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.671362Z", "completed_at": "2025-05-17T21:25:24.697387Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.699390Z", "completed_at": "2025-05-17T21:25:24.699390Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0370328426361084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.relationships_fct_orders_item_uuid__item_uuid__ref_dim_menu_items_.f9ec88fbee", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select item_uuid as from_field\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n    where item_uuid is not null\n),\n\nparent as (\n    select item_uuid as to_field\n    from `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.677369Z", "completed_at": "2025-05-17T21:25:24.698389Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.699390Z", "completed_at": "2025-05-17T21:25:24.699390Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03803420066833496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_fct_orders_item_ordered_id.43ff115a40", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select item_ordered_id as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n  where item_ordered_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.681371Z", "completed_at": "2025-05-17T21:25:24.698389Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.700390Z", "completed_at": "2025-05-17T21:25:24.700390Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.039037227630615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_category_performance_avg_price___0_.073766ce7d", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_category_performance`\n\nwhere not(avg_price >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.691382Z", "completed_at": "2025-05-17T21:25:24.700390Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.704392Z", "completed_at": "2025-05-17T21:25:24.704392Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04103803634643555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_category_performance_avg_price_per_unit___0_.05c884321e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_category_performance`\n\nwhere not(avg_price_per_unit >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.717405Z", "completed_at": "2025-05-17T21:25:24.741426Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.742428Z", "completed_at": "2025-05-17T21:25:24.742428Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03403115272521973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_category_performance_total_revenue_30d___0_.c315b16e27", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_category_performance`\n\nwhere not(total_revenue_30d >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.723410Z", "completed_at": "2025-05-17T21:25:24.743428Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.744430Z", "completed_at": "2025-05-17T21:25:24.744430Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0370335578918457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_category_performance_total_revenue_7d___0.bba097983c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_category_performance`\n\nwhere not(total_revenue_7d >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.729416Z", "completed_at": "2025-05-17T21:25:24.743428Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.747432Z", "completed_at": "2025-05-17T21:25:24.747432Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.039035797119140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_category_performance_total_units_sold_30d___0_.8f3fe48be0", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_category_performance`\n\nwhere not(total_units_sold_30d >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.734421Z", "completed_at": "2025-05-17T21:25:24.744430Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.748435Z", "completed_at": "2025-05-17T21:25:24.748435Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03903603553771973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_category_performance_total_units_sold_7d___0_.2adb4a1d35", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_category_performance`\n\nwhere not(total_units_sold_7d >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.761445Z", "completed_at": "2025-05-17T21:25:24.777461Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.783464Z", "completed_at": "2025-05-17T21:25:24.783464Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031027793884277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_category_performance_avg_price.51b124e7fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_price\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_category_performance`\nwhere avg_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.768450Z", "completed_at": "2025-05-17T21:25:24.783464Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.787469Z", "completed_at": "2025-05-17T21:25:24.787469Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03303050994873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_category_performance_avg_price_per_unit.d1c50d715f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_price_per_unit\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_category_performance`\nwhere avg_price_per_unit is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.772454Z", "completed_at": "2025-05-17T21:25:24.784466Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.788469Z", "completed_at": "2025-05-17T21:25:24.788469Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03403210639953613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_category_performance_category.a23d4da1b4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_category_performance`\nwhere category is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.777461Z", "completed_at": "2025-05-17T21:25:24.785466Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.788469Z", "completed_at": "2025-05-17T21:25:24.788469Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.036031484603881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_category_performance_menu_source.1bad3d7d85", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect menu_source\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_category_performance`\nwhere menu_source is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.801481Z", "completed_at": "2025-05-17T21:25:24.816496Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.822500Z", "completed_at": "2025-05-17T21:25:24.822500Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030027151107788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_hourly_drink_sales", "compiled": true, "compiled_code": "with base as (\n    select\n        datetime_trunc(datetime_ordered, hour) as order_hour_dt,\n        date(datetime_ordered) as order_date,\n        extract(hour from datetime_ordered) as hour_of_day,\n        order_uuid,\n        table_no,\n        item_uuid,\n        quantity,\n        total_item_revenue,\n        price,\n        category\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n    where production_department = 'bar'\n),\n\ntop_drink_category as (\n    select\n        order_hour_dt,\n        category as top_drink_category_name_per_hour,\n        sum(quantity * price) as top_drink_category_revenue_per_hour,\n        rank() over (partition by order_hour_dt order by sum(quantity * price) desc) as rnk\n    from base\n    group by order_hour_dt, category\n),\n\nbar_peak_hours as (\n    select\n        order_hour_dt,\n        row_number() over (partition by order_date order by sum(quantity) desc) as bar_hour_rank\n    from base\n    group by order_hour_dt, order_date\n),\n\ndrink_agg as (\n    select\n        order_hour_dt,\n        order_date,\n        hour_of_day,\n        count(distinct table_no) as distinct_drink_tables_per_hour,\n        array_to_string(array_agg(distinct cast(table_no as string) order by table_no), ',') as open_table_ids_per_hour,\n        count(distinct order_uuid) as total_drink_orders_per_hour,\n        sum(quantity) as total_drink_items_ordered_per_hour,\n        sum(total_item_revenue) as total_drink_revenue_per_hour,\n        round(sum(total_item_revenue) / nullif(sum(quantity), 0), 2) as avg_revenue_per_drink_item_per_hour,\n        count(distinct item_uuid) as unique_drink_items_ordered_per_hour,\n        count(distinct category) as drink_category_diversity_per_hour\n    from base\n    group by order_hour_dt, order_date, hour_of_day\n)\n\n\nselect\n    d.order_hour_dt,\n    d.order_date,\n    d.hour_of_day,\n    d.total_drink_items_ordered_per_hour,\n    d.total_drink_revenue_per_hour,\n    d.avg_revenue_per_drink_item_per_hour,\n    td.top_drink_category_name_per_hour,\n    td.top_drink_category_revenue_per_hour,\n    round(td.top_drink_category_revenue_per_hour / nullif(d.total_drink_revenue_per_hour, 0), 2) as pct_top_drink_cat_of_drink_revenue_per_hour,\n    d.distinct_drink_tables_per_hour,\n    d.open_table_ids_per_hour,\n    d.total_drink_orders_per_hour,\n    round(d.total_drink_revenue_per_hour / nullif(d.total_drink_orders_per_hour, 0), 2) as avg_revenue_per_drink_order_per_hour,\n    round(d.total_drink_items_ordered_per_hour / nullif(d.total_drink_orders_per_hour, 0), 2) as avg_items_per_drink_order_per_hour,\n    cc.total_mains_ordered_per_hour as new_customers_per_hour,\n    coalesce(round(d.total_drink_items_ordered_per_hour / nullif(cc.total_mains_ordered_per_hour, 0), 2), 0) as avg_drink_items_per_head_per_hour,\n    coalesce(round(d.total_drink_revenue_per_hour / nullif(cc.total_mains_ordered_per_hour, 0), 2), 0) as avg_drink_revenue_per_head_per_hour,\n    d.unique_drink_items_ordered_per_hour,\n    d.drink_category_diversity_per_hour,\n    b.bar_hour_rank <= 2 as is_bar_peak_hour,\n    case \n      when extract(dayofweek from d.order_date) in (1, 6, 7) then true\n      else false\n    end as is_weekend\nfrom drink_agg d\nleft join top_drink_category td on d.order_hour_dt = td.order_hour_dt and td.rnk = 1\nleft join bar_peak_hours b on d.order_hour_dt = b.order_hour_dt\nleft join `annular-mesh-453913-r6`.`dbt_`.`agg_customer_counts` cc on d.order_hour_dt = cc.order_hour_dt\norder by d.order_hour_dt desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.807486Z", "completed_at": "2025-05-17T21:25:24.823501Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.826504Z", "completed_at": "2025-05-17T21:25:24.826504Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03403139114379883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_hourly_food_sales", "compiled": true, "compiled_code": "with base as (\n    select\n        datetime_trunc(datetime_ordered, hour) as order_hour_dt,\n        date(datetime_ordered) as order_date,\n        extract(hour from datetime_ordered) as hour_of_day,\n        order_uuid,\n        table_no,\n        item_uuid,\n        quantity,\n        total_item_revenue,\n        price,\n        category\n    from `annular-mesh-453913-r6`.`dbt_`.`fct_orders`\n    where production_department = 'kitchen'\n),\n\ntop_food_category as (\n    select\n        order_hour_dt,\n        category as top_food_category_name_per_hour,\n        sum(quantity * price) as top_food_category_revenue_per_hour,\n        rank() over (partition by order_hour_dt order by sum(quantity * price) desc) as rnk\n    from base\n    group by order_hour_dt, category\n),\n\nkitchen_peak_hours as (\n    select\n        order_hour_dt,\n        row_number() over (partition by order_date order by sum(quantity) desc) as kitchen_hour_rank\n    from base\n    group by order_hour_dt, order_date\n),\n\nfood_agg as (\n    select\n        order_hour_dt,\n        order_date,\n        hour_of_day,\n        count(distinct table_no) as distinct_food_tables_per_hour,\n        array_to_string(array_agg(distinct cast(table_no as string) order by table_no), ',') as open_table_ids_per_hour,\n        count(distinct order_uuid) as total_food_orders_per_hour,\n        sum(quantity) as total_food_items_ordered_per_hour,\n        round(sum(total_item_revenue), 2) as total_food_revenue_per_hour,\n        round(sum(total_item_revenue) / nullif(sum(quantity), 0), 2) as avg_revenue_per_food_item_per_hour,\n        count(distinct item_uuid) as unique_food_items_ordered_per_hour,\n        count(distinct category) as food_category_diversity_per_hour\n    from base\n    group by order_hour_dt, order_date, hour_of_day\n)\n\n\nselect\n    f.order_hour_dt,\n    f.order_date,\n    f.hour_of_day,\n    f.total_food_items_ordered_per_hour,\n    f.total_food_revenue_per_hour,\n    f.avg_revenue_per_food_item_per_hour,\n    tf.top_food_category_name_per_hour,\n    tf.top_food_category_revenue_per_hour,\n    coalesce(round(tf.top_food_category_revenue_per_hour / nullif(f.total_food_revenue_per_hour, 0), 2),0) as pct_top_food_cat_of_food_revenue_per_hour,\n    f.distinct_food_tables_per_hour,\n    f.open_table_ids_per_hour,\n    coalesce(cc.total_mains_ordered_per_hour, 0) as total_mains_ordered_per_hour,\n    coalesce(round(f.total_food_revenue_per_hour / nullif(cc.total_mains_ordered_per_hour, 0), 2),0) as avg_food_revenue_per_head_per_hour,\n    coalesce(round(f.total_food_items_ordered_per_hour / nullif(cc.total_mains_ordered_per_hour, 0), 2), 0) as avg_food_items_per_head_per_hour,\n    f.total_food_orders_per_hour,\n    coalesce(round(f.total_food_revenue_per_hour / nullif(f.total_food_orders_per_hour, 0), 2),0) as avg_revenue_per_food_order_per_hour,\n    coalesce(round(f.total_food_items_ordered_per_hour / nullif(f.total_food_orders_per_hour, 0), 2),0) as avg_items_per_food_order_per_hour,\n    f.unique_food_items_ordered_per_hour,\n    f.food_category_diversity_per_hour,\n    (k.kitchen_hour_rank <= 2) as is_kitchen_peak_hour,\n    case \n      when extract(dayofweek from f.order_date) in (1, 6, 7) then true\n      else false\n    end as is_weekend\nfrom food_agg f\nleft join top_food_category tf on f.order_hour_dt = tf.order_hour_dt and tf.rnk = 1\nleft join kitchen_peak_hours k on f.order_hour_dt = k.order_hour_dt\nleft join `annular-mesh-453913-r6`.`dbt_`.`agg_customer_counts` cc on f.order_hour_dt = cc.order_hour_dt\norder by f.order_hour_dt desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.811491Z", "completed_at": "2025-05-17T21:25:24.823501Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.827506Z", "completed_at": "2025-05-17T21:25:24.828507Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03503227233886719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_item_performance_total_menu_source__a_la_carte__wine__dessert__cocktails_and_beer.4e060d3546", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        menu_source as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_total`\n    group by menu_source\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'a_la_carte','wine','dessert','cocktails_and_beer'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.816496Z", "completed_at": "2025-05-17T21:25:24.827506Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.831508Z", "completed_at": "2025-05-17T21:25:24.831508Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03903508186340332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_item_performance_total_avg_order_hour__24__0.181d79d065", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_total`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not avg_order_hour >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not avg_order_hour <= 24\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.842519Z", "completed_at": "2025-05-17T21:25:24.855530Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.866540Z", "completed_at": "2025-05-17T21:25:24.866540Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03403043746948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_item_performance_total_percent_of_total_sales__100__0.4490803867", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_total`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not percent_of_total_sales >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not percent_of_total_sales <= 100\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.849526Z", "completed_at": "2025-05-17T21:25:24.866540Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.869543Z", "completed_at": "2025-05-17T21:25:24.869543Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03303074836730957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_item_performance_total_total_revenue___0_.8157fc0670", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_total`\n\nwhere not(total_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.856532Z", "completed_at": "2025-05-17T21:25:24.867541Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.871545Z", "completed_at": "2025-05-17T21:25:24.871545Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03503155708312988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_item_performance_total_total_units_sold___0_.aaffeb542c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_total`\n\nwhere not(total_units_sold >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.861537Z", "completed_at": "2025-05-17T21:25:24.870544Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.874548Z", "completed_at": "2025-05-17T21:25:24.874548Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03102850914001465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_item_performance_total_item_category.bd180f74c3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_category\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_total`\nwhere item_category is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.885557Z", "completed_at": "2025-05-17T21:25:24.900571Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.906578Z", "completed_at": "2025-05-17T21:25:24.906578Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03103184700012207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_item_performance_total_item_name.09051f6158", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_name\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_total`\nwhere item_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.889561Z", "completed_at": "2025-05-17T21:25:24.906578Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.908581Z", "completed_at": "2025-05-17T21:25:24.908581Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.035032033920288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_item_performance_total_item_uuid.d59af4ffe7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect item_uuid\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_total`\nwhere item_uuid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.896567Z", "completed_at": "2025-05-17T21:25:24.907578Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.911584Z", "completed_at": "2025-05-17T21:25:24.911584Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603363037109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_item_performance_total_menu_source.fdb34fbd23", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect menu_source\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_total`\nwhere menu_source is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.901572Z", "completed_at": "2025-05-17T21:25:24.908581Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.912583Z", "completed_at": "2025-05-17T21:25:24.912583Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0370328426361084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_item_performance_total_percent_of_total_sales.a03d3d8905", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect percent_of_total_sales\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_total`\nwhere percent_of_total_sales is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.927596Z", "completed_at": "2025-05-17T21:25:24.948615Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.950618Z", "completed_at": "2025-05-17T21:25:24.950618Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0320286750793457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_item_performance_total_total_revenue.210bfcd51f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_revenue\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_total`\nwhere total_revenue is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.933601Z", "completed_at": "2025-05-17T21:25:24.949616Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.951618Z", "completed_at": "2025-05-17T21:25:24.951618Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03202939033508301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_item_performance_total_total_units_sold.411c818a19", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_units_sold\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_total`\nwhere total_units_sold is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.938607Z", "completed_at": "2025-05-17T21:25:24.950618Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.954620Z", "completed_at": "2025-05-17T21:25:24.955621Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603482246398926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.relationships_agg_item_performance_total_item_uuid__item_uuid__ref_dim_menu_items_.ec00fe5960", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select item_uuid as from_field\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_item_performance_total`\n    where item_uuid is not null\n),\n\nparent as (\n    select item_uuid as to_field\n    from `annular-mesh-453913-r6`.`dbt_`.`dim_menu_items`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.944612Z", "completed_at": "2025-05-17T21:25:24.952618Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.957623Z", "completed_at": "2025-05-17T21:25:24.957623Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03803539276123047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_dim_time_datetime_ordered.cbec1c07f1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect datetime_ordered\nfrom `annular-mesh-453913-r6`.`dbt_`.`dim_time`\nwhere datetime_ordered is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.968634Z", "completed_at": "2025-05-17T21:25:24.982646Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.993656Z", "completed_at": "2025-05-17T21:25:24.993656Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03303074836730957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_dim_time_datetime_ordered.177af51b2a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select datetime_ordered as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`dim_time`\n  where datetime_ordered is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.976640Z", "completed_at": "2025-05-17T21:25:24.987652Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.993656Z", "completed_at": "2025-05-17T21:25:24.993656Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.035032033920288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_daily_drink_sales", "compiled": true, "compiled_code": "with hourly as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n),\n\nmetadata as (\n    select\n        order_date,\n        drink_category_diversity_all_day,\n        distinct_drink_tables_used_all_day,\n        unique_drink_items_ordered_all_day\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_metadata`\n),\n\ncustomers as (\n    select\n        order_date,\n        sum(new_customers_per_hour) as total_customers_all_day\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n    group by order_date\n),\n\n\n\npeak_hours as (\n    select\n        order_date,\n        string_agg(cast(hour_of_day as string), ',' order by hour_of_day) as bar_peak_hours,\n        max(is_weekend) as is_weekend\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n    where is_bar_peak_hour\n    group by order_date\n)\n\nselect\n    h.order_date,\n\n    sum(h.total_drink_items_ordered_per_hour) as total_drink_items_ordered_all_day,\n    sum(h.total_drink_revenue_per_hour) as total_daily_drink_revenue,\n    round(\n        sum(h.total_drink_revenue_per_hour) / nullif(sum(h.total_drink_items_ordered_per_hour), 0), 2\n    ) as avg_daily_revenue_per_drink_item,\n\n    coalesce(max(m.drink_category_diversity_all_day), 0) as drink_category_diversity_all_day,\n    max_by(h.top_drink_category_name_per_hour, h.top_drink_category_revenue_per_hour) as top_daily_drink_category_name,\n    max(h.top_drink_category_revenue_per_hour) as top_daily_drink_category_revenue,\n    round(\n        max(h.top_drink_category_revenue_per_hour) / nullif(sum(h.total_drink_revenue_per_hour), 0), 2\n    ) as pct_top_drink_cat_from_daily_drink_revenue,\n\n    coalesce(max(m.distinct_drink_tables_used_all_day), 0) as distinct_drink_tables_all_day,\n    sum(h.total_drink_orders_per_hour) as total_drink_orders_all_day,\n\n    -- New metrics\n    round(sum(h.total_drink_revenue_per_hour) / nullif(sum(h.total_drink_orders_per_hour), 0), 2) as avg_revenue_per_drink_order_all_day,\n    round(sum(h.total_drink_items_ordered_per_hour) / nullif(sum(h.total_drink_orders_per_hour), 0), 2) as avg_items_per_drink_order_all_day,\n\n    c.total_customers_all_day,\n    round(sum(h.total_drink_revenue_per_hour) / nullif(c.total_customers_all_day, 0), 2) as avg_drink_revenue_per_head_all_day,\n    round(sum(h.total_drink_items_ordered_per_hour) / nullif(c.total_customers_all_day, 0), 2) as avg_drink_items_per_head_all_day,\n\n    coalesce(max(m.unique_drink_items_ordered_all_day), 0) as unique_drink_items_ordered_all_day,\n    ph.bar_peak_hours,\n    ph.is_weekend\n\nfrom hourly h\nleft join metadata m on h.order_date = m.order_date\nleft join customers c on h.order_date = c.order_date\nleft join peak_hours ph on h.order_date = ph.order_date\ngroup by h.order_date, c.total_customers_all_day, ph.bar_peak_hours, ph.is_weekend\norder by h.order_date desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.982646Z", "completed_at": "2025-05-17T21:25:24.994658Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:24.998661Z", "completed_at": "2025-05-17T21:25:24.998661Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603363037109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_hourly_drink_sales_is_bar_peak_hour__False__True__False.af5c5a9a75", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        is_bar_peak_hour as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n    group by is_bar_peak_hour\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    True,False\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:24.988652Z", "completed_at": "2025-05-17T21:25:24.997659Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.001663Z", "completed_at": "2025-05-17T21:25:25.001663Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03403115272521973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_hourly_drink_sales_is_weekend__False__True__False.8f4747307c", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        is_weekend as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n    group by is_weekend\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    True,False\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.013674Z", "completed_at": "2025-05-17T21:25:25.030689Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.037698Z", "completed_at": "2025-05-17T21:25:25.037698Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.035031795501708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_hourly_drink_sales_top_drink_category_name_per_hour__Beers_Cider__Lo_No_Alc__Port_Sherry__Ultimate_Steakhouse_Cocktails__Time_A_Place__Rarities__The_Sacred_Six__Red_Wines__Champagne_Sparkling__Rose_Wines__Dessert_Wines__White_Wines__Magnums__Bordeaux__Burgundy.261d498c1b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        top_drink_category_name_per_hour as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n    group by top_drink_category_name_per_hour\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Beers & Cider','Lo & No Alc','Port & Sherry','Ultimate Steakhouse Cocktails','Time & A Place','Rarities','The Sacred Six','Red Wines','Champagne & Sparkling','Rose Wines','Dessert Wines','White Wines','Magnums','Bordeaux','Burgundy'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.019680Z", "completed_at": "2025-05-17T21:25:25.036696Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.038697Z", "completed_at": "2025-05-17T21:25:25.038697Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.033029794692993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_hourly_drink_sales_hour_of_day__23__0.3e29f6efcf", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not hour_of_day >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not hour_of_day <= 23\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.024684Z", "completed_at": "2025-05-17T21:25:25.037698Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.040698Z", "completed_at": "2025-05-17T21:25:25.040698Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03503155708312988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_hourly_drink_sales_pct_top_drink_cat_of_drink_revenue_per_hour__1__0.e57c775c7b", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_drink_cat_of_drink_revenue_per_hour >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_drink_cat_of_drink_revenue_per_hour <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.031691Z", "completed_at": "2025-05-17T21:25:25.038697Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.044702Z", "completed_at": "2025-05-17T21:25:25.044702Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03202986717224121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_avg_drink_items_per_head_per_hour___0.dfaaa0fa7a", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(avg_drink_items_per_head_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.056714Z", "completed_at": "2025-05-17T21:25:25.079731Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.081732Z", "completed_at": "2025-05-17T21:25:25.082733Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034028053283691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_avg_drink_items_per_head_per_hour___total_drink_items_ordered_per_hour.812f1ef606", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(avg_drink_items_per_head_per_hour <= total_drink_items_ordered_per_hour)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.062718Z", "completed_at": "2025-05-17T21:25:25.081732Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.083735Z", "completed_at": "2025-05-17T21:25:25.083735Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03602933883666992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_avg_drink_revenue_per_head_per_hour___0.cc50bd090d", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(avg_drink_revenue_per_head_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.068721Z", "completed_at": "2025-05-17T21:25:25.082733Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.086737Z", "completed_at": "2025-05-17T21:25:25.086737Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03803253173828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_avg_drink_revenue_per_head_per_hour___total_drink_revenue_per_hour.8ee23b6bc6", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(avg_drink_revenue_per_head_per_hour <= total_drink_revenue_per_hour)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.074726Z", "completed_at": "2025-05-17T21:25:25.084735Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.089739Z", "completed_at": "2025-05-17T21:25:25.089739Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04003286361694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_avg_items_per_drink_order_per_hour___1.d4e4c2e2a0", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(avg_items_per_drink_order_per_hour >= 1)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.099748Z", "completed_at": "2025-05-17T21:25:25.118766Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.125772Z", "completed_at": "2025-05-17T21:25:25.125772Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.036032915115356445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_avg_items_per_drink_order_per_hour___total_drink_items_ordered_per_hour.f3e179be57", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(avg_items_per_drink_order_per_hour <= total_drink_items_ordered_per_hour)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.107756Z", "completed_at": "2025-05-17T21:25:25.124771Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.126773Z", "completed_at": "2025-05-17T21:25:25.126773Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.036032915115356445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_avg_revenue_per_drink_item_per_hour___0.023de2042a", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(avg_revenue_per_drink_item_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.113761Z", "completed_at": "2025-05-17T21:25:25.126773Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.129776Z", "completed_at": "2025-05-17T21:25:25.129776Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.036034345626831055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_avg_revenue_per_drink_item_per_hour___total_drink_revenue_per_hour.afdadd8a60", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(avg_revenue_per_drink_item_per_hour <= total_drink_revenue_per_hour)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.119767Z", "completed_at": "2025-05-17T21:25:25.127774Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.132779Z", "completed_at": "2025-05-17T21:25:25.132779Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03202986717224121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_avg_revenue_per_drink_order_per_hour___0.3fed9674e6", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(avg_revenue_per_drink_order_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.144791Z", "completed_at": "2025-05-17T21:25:25.165808Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.167810Z", "completed_at": "2025-05-17T21:25:25.167810Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031142473220825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_avg_revenue_per_drink_order_per_hour___total_drink_revenue_per_hour.93e1f9af63", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(avg_revenue_per_drink_order_per_hour <= total_drink_revenue_per_hour)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.149794Z", "completed_at": "2025-05-17T21:25:25.166810Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.167810Z", "completed_at": "2025-05-17T21:25:25.167810Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03214406967163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_distinct_drink_tables_per_hour___0.7e82d1f7eb", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(distinct_drink_tables_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.154798Z", "completed_at": "2025-05-17T21:25:25.168926Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.173930Z", "completed_at": "2025-05-17T21:25:25.173930Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.036149024963378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_distinct_drink_tables_per_hour___50.46da344194", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(distinct_drink_tables_per_hour <= 50)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.160806Z", "completed_at": "2025-05-17T21:25:25.168926Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.174932Z", "completed_at": "2025-05-17T21:25:25.174932Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03614687919616699, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_drink_category_diversity_per_hour___0.5fdb5ba869", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(drink_category_diversity_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.184941Z", "completed_at": "2025-05-17T21:25:25.207962Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.209962Z", "completed_at": "2025-05-17T21:25:25.209962Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03303050994873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_top_drink_category_revenue_per_hour___0.786b3bbdfa", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(top_drink_category_revenue_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.191947Z", "completed_at": "2025-05-17T21:25:25.208963Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.210964Z", "completed_at": "2025-05-17T21:25:25.210964Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03603243827819824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_top_drink_category_revenue_per_hour___total_drink_revenue_per_hour.65074ddea5", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(top_drink_category_revenue_per_hour <= total_drink_revenue_per_hour)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.198954Z", "completed_at": "2025-05-17T21:25:25.209962Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.211964Z", "completed_at": "2025-05-17T21:25:25.211964Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0350337028503418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_total_drink_items_ordered_per_hour___0.3450c2e2d6", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(total_drink_items_ordered_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.203958Z", "completed_at": "2025-05-17T21:25:25.211964Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.214967Z", "completed_at": "2025-05-17T21:25:25.214967Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03803586959838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_total_drink_orders_per_hour___0.5ad7584efe", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(total_drink_orders_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.228980Z", "completed_at": "2025-05-17T21:25:25.248999Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.251000Z", "completed_at": "2025-05-17T21:25:25.251000Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031028270721435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_total_drink_revenue_per_hour___0.573915afdc", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(total_drink_revenue_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.233984Z", "completed_at": "2025-05-17T21:25:25.250000Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.252002Z", "completed_at": "2025-05-17T21:25:25.252002Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.032029151916503906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_drink_sales_unique_drink_items_ordered_per_hour___0.9462412e98", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n\nwhere not(unique_drink_items_ordered_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.239991Z", "completed_at": "2025-05-17T21:25:25.251000Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.254003Z", "completed_at": "2025-05-17T21:25:25.254003Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03503131866455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_hourly_drink_sales_hour_of_day.2583d9df37", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect hour_of_day\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\nwhere hour_of_day is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.244995Z", "completed_at": "2025-05-17T21:25:25.253002Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.258007Z", "completed_at": "2025-05-17T21:25:25.258007Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03603219985961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_hourly_drink_sales_order_date.0de88677a0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_date\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\nwhere order_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.270018Z", "completed_at": "2025-05-17T21:25:25.291037Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.292038Z", "completed_at": "2025-05-17T21:25:25.292038Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030027151107788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_hourly_drink_sales_order_hour_dt.261b9a4fe9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_hour_dt\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\nwhere order_hour_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.276022Z", "completed_at": "2025-05-17T21:25:25.291037Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.293038Z", "completed_at": "2025-05-17T21:25:25.293038Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03302955627441406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_agg_hourly_drink_sales_order_hour_dt.4361589091", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_hour_dt as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n  where order_hour_dt is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.281027Z", "completed_at": "2025-05-17T21:25:25.292038Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.294040Z", "completed_at": "2025-05-17T21:25:25.294040Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.034032583236694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_daily_food_sales", "compiled": true, "compiled_code": "with hourly as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n),\n\nmetadata as (\n    select\n        order_date,\n        food_category_diversity_all_day,\n        distinct_food_tables_used_all_day,\n        unique_food_items_ordered_all_day\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_metadata`\n),\n\npeak_hours as (\n    select\n        order_date,\n        string_agg(cast(hour_of_day as string), ',' order by hour_of_day) as kitchen_peak_hours,\n        max(is_weekend) as is_weekend\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n    where is_kitchen_peak_hour\n    group by order_date\n)\n\nselect\n    h.order_date,\n\n    sum(h.total_food_items_ordered_per_hour) as total_food_items_sold_all_day,\n    sum(h.total_food_revenue_per_hour) as total_daily_food_revenue,\n    round(sum(h.total_food_revenue_per_hour) / nullif(sum(h.total_food_items_ordered_per_hour), 0), 2) as avg_daily_revenue_per_food_item,\n\n    coalesce(max(m.food_category_diversity_all_day), 0) as food_category_diversity_all_day,\n    max_by(h.top_food_category_name_per_hour, h.top_food_category_revenue_per_hour) as top_daily_food_category_name,\n    max(h.top_food_category_revenue_per_hour) as top_daily_food_category_revenue,\n    round(max(h.top_food_category_revenue_per_hour) / nullif(sum(h.total_food_revenue_per_hour), 0), 2) as pct_top_food_cat_from_daily_food_revenue,\n\n    coalesce(max(m.distinct_food_tables_used_all_day), 0) as distinct_food_tables_all_day,\n    sum(h.total_food_orders_per_hour) as total_food_orders_all_day,\n    round(sum(h.total_food_revenue_per_hour) / nullif(sum(h.total_food_orders_per_hour), 0), 2) as avg_revenue_per_food_order_all_day,\n    round(sum(h.total_food_items_ordered_per_hour) / nullif(sum(h.total_food_orders_per_hour), 0), 2) as avg_items_per_food_order_all_day,\n\n    sum(h.total_mains_ordered_per_hour) as total_customers_all_day,\n    round(sum(h.total_food_revenue_per_hour) / nullif(sum(h.total_mains_ordered_per_hour), 0), 2) as avg_food_revenue_per_head_all_day,\n    round(sum(h.total_food_items_ordered_per_hour) / nullif(sum(h.total_mains_ordered_per_hour), 0), 2) as avg_food_items_per_head_all_day,\n\n    coalesce(max(m.unique_food_items_ordered_all_day), 0) as unique_food_items_ordered_all_day,\n    ph.kitchen_peak_hours,\n    ph.is_weekend\n\nfrom hourly h\nleft join metadata m on h.order_date = m.order_date\nleft join peak_hours ph on h.order_date = ph.order_date\ngroup by h.order_date, ph.kitchen_peak_hours, ph.is_weekend\norder by h.order_date desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.286032Z", "completed_at": "2025-05-17T21:25:25.293038Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.299044Z", "completed_at": "2025-05-17T21:25:25.299044Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03603363037109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_hourly_total_sales", "compiled": true, "compiled_code": "\n\n-- Food hourly metrics\nwith food as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n),\n\n-- Drink hourly metrics\ndrink as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_drink_sales`\n),\n\n-- Combine food + drink metrics on shared hour\ncombined as (\n    select\n        f.order_hour_dt,\n        f.order_date,\n        f.hour_of_day,\n        f.total_food_items_ordered_per_hour,\n        d.total_drink_items_ordered_per_hour,\n        f.total_food_revenue_per_hour,\n        d.total_drink_revenue_per_hour,\n        f.top_food_category_name_per_hour,\n        f.top_food_category_revenue_per_hour,\n        d.top_drink_category_name_per_hour,\n        d.top_drink_category_revenue_per_hour,\n        f.total_mains_ordered_per_hour,  -- used as a proxy for total customers (1 customer = 1 main)\n        f.total_food_orders_per_hour as food_orders,\n        d.total_drink_orders_per_hour as drink_orders,\n        f.unique_food_items_ordered_per_hour,\n        d.unique_drink_items_ordered_per_hour,\n        f.food_category_diversity_per_hour,\n        d.drink_category_diversity_per_hour,\n        f.is_kitchen_peak_hour,\n        d.is_bar_peak_hour,\n        array_to_string(\n            array(\n                select distinct t\n                from unnest(\n                    split(coalesce(f.open_table_ids_per_hour, '') || ',' || coalesce(d.open_table_ids_per_hour, ''), ',')\n                ) as t\n                where safe_cast(t as int) is not null\n                order by cast(t as int)\n            ),\n            ','\n        ) as open_table_ids_per_hour\n    from food f\n    join drink d on f.order_hour_dt = d.order_hour_dt\n)\n\nselect\n    order_hour_dt,\n    order_date,\n    hour_of_day,\n    \n    -- Total items ordered: food plus drink\n    (total_food_items_ordered_per_hour + total_drink_items_ordered_per_hour) as total_items_ordered_per_hour,\n    \n    -- Total revenue: food plus drink\n    (total_food_revenue_per_hour + total_drink_revenue_per_hour) as total_revenue_per_hour,\n    \n    -- Average revenue per item: total revenue divided by total items ordered\n    round((total_food_revenue_per_hour + total_drink_revenue_per_hour) /\n          nullif((total_food_items_ordered_per_hour + total_drink_items_ordered_per_hour), 0), 2) as avg_revenue_per_item_per_hour,\n    \n    -- Percentage of total revenue from food\n    round(total_food_revenue_per_hour /\n          nullif((total_food_revenue_per_hour + total_drink_revenue_per_hour), 0), 2) as pct_food_revenue_per_hour,\n    \n    -- Percentage of total revenue from drink\n    round(total_drink_revenue_per_hour /\n          nullif((total_food_revenue_per_hour + total_drink_revenue_per_hour), 0), 2) as pct_drink_revenue_per_hour,\n    \n    -- Determine the top category based on which revenue is higher (food or drink)\n    case \n      when top_food_category_revenue_per_hour >= top_drink_category_revenue_per_hour then top_food_category_name_per_hour\n      else top_drink_category_name_per_hour\n    end as top_category_name_per_hour,\n    \n    case \n      when top_food_category_revenue_per_hour >= top_drink_category_revenue_per_hour then top_food_category_revenue_per_hour\n      else top_drink_category_revenue_per_hour\n    end as top_category_revenue_per_hour,\n    \n    -- Percentage of total revenue contributed by the top category\n    round(\n      case \n        when top_food_category_revenue_per_hour >= top_drink_category_revenue_per_hour then top_food_category_revenue_per_hour\n        else top_drink_category_revenue_per_hour\n      end / nullif((total_food_revenue_per_hour + total_drink_revenue_per_hour), 0), 2\n    ) as pct_top_cat_of_total_revenue_per_hour,\n    \n    -- Total customers per hour (using mains ordered as a proxy)\n    total_mains_ordered_per_hour as total_new_customers_per_hour,\n    \n    -- Average revenue per head: total revenue divided by total customers\n    coalesce(\n        round((total_food_revenue_per_hour + total_drink_revenue_per_hour) /\n              nullif(total_mains_ordered_per_hour, 0), 2)\n    ) as avg_revenue_per_head_per_hour,\n    \n    -- Average revenue per order: total revenue divided by total (food + drink) orders\n    round((total_food_revenue_per_hour + total_drink_revenue_per_hour) /\n        nullif((food_orders + drink_orders), 0), 2\n    ) as avg_revenue_per_order_per_hour,\n\n    -- Average items ordered per head: total items divided by total customers\n    coalesce(\n        round((total_food_items_ordered_per_hour + total_drink_items_ordered_per_hour) /\n              nullif(total_mains_ordered_per_hour, 0), 2)\n    ) as avg_items_ordered_per_head_per_hour,\n\n    -- Average items per order: total items divided by total (food + drink) orders\n    round((total_food_items_ordered_per_hour + total_drink_items_ordered_per_hour) /\n      nullif((food_orders + drink_orders), 0), 2) as avg_items_per_order_per_hour,\n    \n    -- Total orders per hour (sum of unique food and drink orders)\n    (food_orders + drink_orders) as total_orders_per_hour,\n    \n    -- Unique items ordered (sum from food and drink; note: this is a naive summation)\n    (unique_food_items_ordered_per_hour + unique_drink_items_ordered_per_hour) as unique_items_ordered_per_hour,\n    \n    -- Category diversity: sum of unique categories from food and drink\n    (food_category_diversity_per_hour + drink_category_diversity_per_hour) as category_diversity_per_hour,\n\n    -- Recalculated distinct tables from open_table_ids list\n    array_length(split(open_table_ids_per_hour, ',')) as distinct_tables_per_hour,\n\n    -- Full list of distinct table numbers as a CSV string\n    open_table_ids_per_hour,\n\n    -- is_weekend: true if the order_date falls on Friday, Saturday, or Sunday.\n    case \n      when extract(dayofweek from order_date) in (1, 6, 7) then true\n      else false\n    end as is_weekend,\n    \n    -- is_peak_hour: true if either model show a peak hour indicator\n    (is_kitchen_peak_hour or is_bar_peak_hour) as is_peak_hour\n\nfrom combined\norder by order_hour_dt desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.312056Z", "completed_at": "2025-05-17T21:25:25.329073Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.335076Z", "completed_at": "2025-05-17T21:25:25.335076Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03303050994873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_hourly_food_sales_is_kitchen_peak_hour__False__True__False.8f523c339e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        is_kitchen_peak_hour as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n    group by is_kitchen_peak_hour\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    True,False\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.317060Z", "completed_at": "2025-05-17T21:25:25.335076Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.337079Z", "completed_at": "2025-05-17T21:25:25.337079Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03503274917602539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_hourly_food_sales_is_weekend__False__True__False.1e07b9297e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        is_weekend as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n    group by is_weekend\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    True,False\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.322065Z", "completed_at": "2025-05-17T21:25:25.336078Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.338080Z", "completed_at": "2025-05-17T21:25:25.338080Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.037034034729003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_hourly_food_sales_top_food_category_name_per_hour__Mains__Large_Cuts__Steaks__Cheese__Sides__Sauces__Puddings__Ice_Cream_Sorbet__Extras__Chocolates__Starters.7e80c0ef85", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        top_food_category_name_per_hour as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n    group by top_food_category_name_per_hour\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Mains','Large Cuts','Steaks','Cheese','Sides','Sauces','Puddings','Ice-Cream & Sorbet','Extras','Chocolates','Starters'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.330073Z", "completed_at": "2025-05-17T21:25:25.337079Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.343084Z", "completed_at": "2025-05-17T21:25:25.343084Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.036032676696777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_hourly_food_sales_hour_of_day__23__0.6b8c470f7f", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not hour_of_day >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not hour_of_day <= 23\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.354093Z", "completed_at": "2025-05-17T21:25:25.372111Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.378116Z", "completed_at": "2025-05-17T21:25:25.378116Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03403115272521973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_hourly_food_sales_pct_top_food_cat_of_food_revenue_per_hour__1__0.882cffd670", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_food_cat_of_food_revenue_per_hour >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_food_cat_of_food_revenue_per_hour <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.361101Z", "completed_at": "2025-05-17T21:25:25.377116Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.379117Z", "completed_at": "2025-05-17T21:25:25.379117Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03503108024597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_avg_food_items_per_head_per_hour___0.b363014e6d", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(avg_food_items_per_head_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.367106Z", "completed_at": "2025-05-17T21:25:25.379117Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.381118Z", "completed_at": "2025-05-17T21:25:25.381118Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.036034584045410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_avg_food_revenue_per_head_per_hour___0.b99e787c27", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(avg_food_revenue_per_head_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.372111Z", "completed_at": "2025-05-17T21:25:25.380118Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.386123Z", "completed_at": "2025-05-17T21:25:25.386123Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03803515434265137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_avg_items_per_food_order_per_hour___1.2864290ce4", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(avg_items_per_food_order_per_hour >= 1)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.398135Z", "completed_at": "2025-05-17T21:25:25.420154Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.422157Z", "completed_at": "2025-05-17T21:25:25.422157Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.032028913497924805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_avg_items_per_food_order_per_hour___total_food_items_ordered_per_hour.4940f6a78f", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(avg_items_per_food_order_per_hour <= total_food_items_ordered_per_hour)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.404139Z", "completed_at": "2025-05-17T21:25:25.421156Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.423157Z", "completed_at": "2025-05-17T21:25:25.423157Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03503108024597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_avg_revenue_per_food_item_per_hour___0.c64ad51169", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(avg_revenue_per_food_item_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.409144Z", "completed_at": "2025-05-17T21:25:25.422157Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.426160Z", "completed_at": "2025-05-17T21:25:25.426160Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0370333194732666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_avg_revenue_per_food_item_per_hour___total_food_revenue_per_hour.d707b49bc0", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(avg_revenue_per_food_item_per_hour <= total_food_revenue_per_hour)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.415150Z", "completed_at": "2025-05-17T21:25:25.423157Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.427163Z", "completed_at": "2025-05-17T21:25:25.427163Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.037034034729003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_avg_revenue_per_food_order_per_hour___0.c7f011b15f", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(avg_revenue_per_food_order_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.440172Z", "completed_at": "2025-05-17T21:25:25.463193Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.465196Z", "completed_at": "2025-05-17T21:25:25.465196Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03403210639953613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_avg_revenue_per_food_order_per_hour___total_food_revenue_per_hour.a2c4407d85", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(avg_revenue_per_food_order_per_hour <= total_food_revenue_per_hour)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.447179Z", "completed_at": "2025-05-17T21:25:25.464194Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.466197Z", "completed_at": "2025-05-17T21:25:25.466197Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03403019905090332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_distinct_food_tables_per_hour___0.62c5da7a03", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(distinct_food_tables_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.453184Z", "completed_at": "2025-05-17T21:25:25.466197Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.471201Z", "completed_at": "2025-05-17T21:25:25.471201Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03703427314758301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_distinct_food_tables_per_hour___50.2b0d3c2512", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(distinct_food_tables_per_hour <= 50)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.458190Z", "completed_at": "2025-05-17T21:25:25.467198Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.472202Z", "completed_at": "2025-05-17T21:25:25.472202Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03903484344482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_food_category_diversity_per_hour___1.41c806a20a", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(food_category_diversity_per_hour >= 1)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.484212Z", "completed_at": "2025-05-17T21:25:25.501228Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.507234Z", "completed_at": "2025-05-17T21:25:25.507234Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.032029151916503906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_top_food_category_revenue_per_hour___0.0421d21b43", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(top_food_category_revenue_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.489217Z", "completed_at": "2025-05-17T21:25:25.506232Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.508235Z", "completed_at": "2025-05-17T21:25:25.508235Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03402996063232422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_top_food_category_revenue_per_hour___total_food_revenue_per_hour.c04bf973b7", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(top_food_category_revenue_per_hour <= total_food_revenue_per_hour)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.496224Z", "completed_at": "2025-05-17T21:25:25.507234Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.512239Z", "completed_at": "2025-05-17T21:25:25.512239Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.036034345626831055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_total_food_items_ordered_per_hour___0.7e2b9a6fb4", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(total_food_items_ordered_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.501228Z", "completed_at": "2025-05-17T21:25:25.510238Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.515240Z", "completed_at": "2025-05-17T21:25:25.515240Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0370333194732666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_total_food_orders_per_hour___0.51dd4b1e73", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(total_food_orders_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.527252Z", "completed_at": "2025-05-17T21:25:25.545268Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.551274Z", "completed_at": "2025-05-17T21:25:25.551274Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03403210639953613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_total_food_revenue_per_hour___0.f48f0defae", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(total_food_revenue_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.532257Z", "completed_at": "2025-05-17T21:25:25.550272Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.553276Z", "completed_at": "2025-05-17T21:25:25.553276Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.036032676696777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_total_mains_ordered_per_hour___0.a8d70207b0", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(total_mains_ordered_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.539263Z", "completed_at": "2025-05-17T21:25:25.552275Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.554277Z", "completed_at": "2025-05-17T21:25:25.554277Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.036034345626831055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_food_sales_unique_food_items_ordered_per_hour___0.0432836dff", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n\nwhere not(unique_food_items_ordered_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.546268Z", "completed_at": "2025-05-17T21:25:25.553276Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.558280Z", "completed_at": "2025-05-17T21:25:25.558280Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.038034915924072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_hourly_food_sales_hour_of_day.0b52be9331", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect hour_of_day\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\nwhere hour_of_day is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.570291Z", "completed_at": "2025-05-17T21:25:25.589308Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.590308Z", "completed_at": "2025-05-17T21:25:25.590308Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029027938842773438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_hourly_food_sales_order_date.b7c06f6f07", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_date\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\nwhere order_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.574294Z", "completed_at": "2025-05-17T21:25:25.590308Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.591310Z", "completed_at": "2025-05-17T21:25:25.591310Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03102850914001465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_hourly_food_sales_order_hour_dt.60db913355", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_hour_dt\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\nwhere order_hour_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.580300Z", "completed_at": "2025-05-17T21:25:25.591310Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.595314Z", "completed_at": "2025-05-17T21:25:25.595314Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03403210639953613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_agg_hourly_food_sales_order_hour_dt.7d0717c959", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_hour_dt as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_food_sales`\n  where order_hour_dt is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.585304Z", "completed_at": "2025-05-17T21:25:25.592311Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.598317Z", "completed_at": "2025-05-17T21:25:25.598317Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.035031795501708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_monthly_drink_sales", "compiled": true, "compiled_code": "with daily as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n),\n\nmetadata as (\n    select\n        order_month,\n        drink_category_diversity_all_month,\n        unique_drink_items_ordered_all_month\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_metadata`\n),\n\npeak_hours as (\n    select\n        format_date('%Y-%m', order_date) as order_month,\n        array_to_string(array_agg(distinct hour_str order by hour_str), ',') as bar_peak_hours_monthly\n    from (\n        select\n            order_date,\n            cast(hour as string) as hour_str\n        from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`,\n        unnest(split(bar_peak_hours, ',')) as hour\n    )\n    group by order_month\n),\n\naggregated as (\n    select\n        format_date('%Y-%m', order_date) as order_month,\n        sum(total_drink_items_ordered_all_day) as total_drink_items_sold_monthly,\n        sum(total_daily_drink_revenue) as total_monthly_drink_revenue,\n        round(sum(total_daily_drink_revenue) / nullif(sum(total_drink_items_ordered_all_day), 0), 2) as avg_monthly_revenue_per_drink_item,\n\n        max_by(top_daily_drink_category_name, top_daily_drink_category_revenue) as top_monthly_drink_category_name,\n        max(top_daily_drink_category_revenue) as top_monthly_drink_category_revenue,\n        round(\n            max(top_daily_drink_category_revenue) / nullif(sum(total_daily_drink_revenue), 0),\n            2\n        ) as pct_top_drink_cat_from_monthly_drinks_revenue,\n\n        round(avg(distinct_drink_tables_all_day), 2) as avg_distinct_drink_tables_per_day_monthly,\n        sum(total_drink_orders_all_day) as total_drink_orders_monthly,\n        round(sum(total_daily_drink_revenue) / nullif(sum(total_drink_orders_all_day), 0), 2) as avg_revenue_per_drinks_order_monthly,\n        round(sum(total_drink_items_ordered_all_day) / nullif(sum(total_drink_orders_all_day), 0), 2) as avg_items_per_drinks_order_monthly,\n\n        sum(total_customers_all_day) as total_customers_monthly,\n        round(sum(total_daily_drink_revenue) / nullif(sum(total_customers_all_day), 0), 2) as avg_drinks_revenue_per_head_monthly,\n        round(sum(total_drink_items_ordered_all_day) / nullif(sum(total_customers_all_day), 0), 2) as avg_drink_items_per_head_monthly\n\n    from daily\n    group by order_month\n)\n\nselect\n    a.order_month,\n    a.total_drink_items_sold_monthly,\n    a.total_monthly_drink_revenue,\n    a.avg_monthly_revenue_per_drink_item,\n    a.top_monthly_drink_category_name,\n    a.top_monthly_drink_category_revenue,\n    a.pct_top_drink_cat_from_monthly_drinks_revenue,\n    a.avg_distinct_drink_tables_per_day_monthly,\n    a.total_drink_orders_monthly,\n    a.avg_revenue_per_drinks_order_monthly,\n    a.avg_items_per_drinks_order_monthly,\n    a.total_customers_monthly,\n    a.avg_drinks_revenue_per_head_monthly,\n    a.avg_drink_items_per_head_monthly,\n    coalesce(m.drink_category_diversity_all_month, 0) as drink_category_diversity_monthly,\n    coalesce(m.unique_drink_items_ordered_all_month, 0) as unique_drink_items_ordered_monthly,\n    p.bar_peak_hours_monthly\nfrom aggregated a\nleft join metadata m using (order_month)\nleft join peak_hours p using (order_month)\norder by order_month desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.609326Z", "completed_at": "2025-05-17T21:25:25.627342Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.633349Z", "completed_at": "2025-05-17T21:25:25.633349Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03303098678588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_weekly_drink_sales", "compiled": true, "compiled_code": "with daily as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n),\n\nmetadata as (\n    select\n        order_week,\n        drink_category_diversity_all_week,\n        unique_drink_items_ordered_all_week\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_metadata`\n),\n\npeak_hours as (\n    select\n        format_date('%G-%V', order_date) as order_week,\n        array_to_string(array_agg(distinct hour_str order by hour_str), ',') as bar_peak_hours_weekly\n    from (\n        select\n            order_date,\n            cast(hour as string) as hour_str\n        from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`,\n        unnest(split(bar_peak_hours, ',')) as hour\n    )\n    group by order_week\n),\n\naggregated as (\n    select\n        format_date('%G-%V', order_date) as order_week,\n        min(order_date) as week_start_date,\n        max(order_date) as week_end_date,\n\n        sum(total_drink_items_ordered_all_day) as total_drink_items_sold_weekly,\n        sum(total_daily_drink_revenue) as total_weekly_drink_revenue,\n        round(sum(total_daily_drink_revenue) / nullif(sum(total_drink_items_ordered_all_day), 0), 2) as avg_weekly_revenue_per_drink_item,\n\n        max_by(top_daily_drink_category_name, top_daily_drink_category_revenue) as top_weekly_drink_category_name,\n        max(top_daily_drink_category_revenue) as top_weekly_drink_category_revenue,\n        round(max(top_daily_drink_category_revenue) / nullif(sum(total_daily_drink_revenue), 0), 2) as pct_top_drink_cat_from_weekly_drink_revenue,\n\n        round(avg(distinct_drink_tables_all_day), 2) as avg_distinct_drink_tables_per_day_weekly,\n        sum(total_drink_orders_all_day) as total_drink_orders_weekly,\n        round(sum(total_daily_drink_revenue) / nullif(sum(total_drink_orders_all_day), 0), 2) as avg_revenue_per_drink_order_weekly,\n        round(sum(total_drink_items_ordered_all_day) / nullif(sum(total_drink_orders_all_day), 0), 2) as avg_items_per_drink_order_weekly,\n        sum(total_customers_all_day) as total_customers_weekly,\n        round(sum(total_daily_drink_revenue) / nullif(sum(total_customers_all_day), 0), 2) as avg_drink_revenue_per_head_weekly,\n        round(sum(total_drink_items_ordered_all_day) / nullif(sum(total_customers_all_day), 0), 2) as avg_drink_items_per_haed_weekly\n\n    from daily\n    group by order_week\n),\n\nfinal as (\n    select\n        a.*,\n        m.drink_category_diversity_all_week as drink_category_diversity_weekly,\n        m.unique_drink_items_ordered_all_week as unique_drink_items_ordered_weekly,\n        p.bar_peak_hours_weekly\n    from aggregated a\n    left join metadata m using (order_week)\n    left join peak_hours p using (order_week)\n\n)\n\nselect *\nfrom final\norder by order_week desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.614331Z", "completed_at": "2025-05-17T21:25:25.632347Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.634348Z", "completed_at": "2025-05-17T21:25:25.634348Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03603172302246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_daily_drink_sales_is_weekend__False__True__False.b218e14f76", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        is_weekend as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n    group by is_weekend\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    True,False\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.621337Z", "completed_at": "2025-05-17T21:25:25.634348Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.638354Z", "completed_at": "2025-05-17T21:25:25.638354Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.037034034729003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_daily_drink_sales_top_daily_drink_category_name__Beers_Cider__Lo_No_Alc__Port_Sherry__Ultimate_Steakhouse_Cocktails__Time_A_Place__Rarities__The_Sacred_Six__Red_Wines__Champagne_Sparkling__Rose_Wines__Dessert_Wines__White_Wines__Magnums__Bordeaux__Burgundy.947a6cc3bc", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        top_daily_drink_category_name as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n    group by top_daily_drink_category_name\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Beers & Cider','Lo & No Alc','Port & Sherry','Ultimate Steakhouse Cocktails','Time & A Place','Rarities','The Sacred Six','Red Wines','Champagne & Sparkling','Rose Wines','Dessert Wines','White Wines','Magnums','Bordeaux','Burgundy'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.627342Z", "completed_at": "2025-05-17T21:25:25.635350Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.639355Z", "completed_at": "2025-05-17T21:25:25.639355Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.039034128189086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_daily_drink_sales_pct_top_drink_cat_from_daily_drink_revenue__1__0.d43351dfda", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_drink_cat_from_daily_drink_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_drink_cat_from_daily_drink_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.653367Z", "completed_at": "2025-05-17T21:25:25.670382Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.677390Z", "completed_at": "2025-05-17T21:25:25.677390Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.033030033111572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_avg_daily_revenue_per_drink_item___0.64a7e65dd8", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(avg_daily_revenue_per_drink_item >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.659372Z", "completed_at": "2025-05-17T21:25:25.676387Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.678391Z", "completed_at": "2025-05-17T21:25:25.678391Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03503108024597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_avg_drink_items_per_head_all_day___0.6dbb5186b7", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(avg_drink_items_per_head_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.664376Z", "completed_at": "2025-05-17T21:25:25.678391Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.682393Z", "completed_at": "2025-05-17T21:25:25.682393Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.036034584045410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_avg_drink_items_per_head_all_day___total_drink_items_ordered_all_day.acc5590b4b", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(avg_drink_items_per_head_all_day <= total_drink_items_ordered_all_day)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.671382Z", "completed_at": "2025-05-17T21:25:25.679390Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.684395Z", "completed_at": "2025-05-17T21:25:25.684395Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03803515434265137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_avg_drink_revenue_per_head_all_day___0.730a042cc8", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(avg_drink_revenue_per_head_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.696406Z", "completed_at": "2025-05-17T21:25:25.715422Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.722431Z", "completed_at": "2025-05-17T21:25:25.722431Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03603172302246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_avg_drink_revenue_per_head_all_day___total_daily_drink_revenue.603e0aaab5", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(avg_drink_revenue_per_head_all_day <= total_daily_drink_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.702412Z", "completed_at": "2025-05-17T21:25:25.721429Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.723430Z", "completed_at": "2025-05-17T21:25:25.723430Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0370335578918457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_avg_items_per_drink_order_all_day___1.55f81a3337", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(avg_items_per_drink_order_all_day >= 1)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.710419Z", "completed_at": "2025-05-17T21:25:25.722431Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.727435Z", "completed_at": "2025-05-17T21:25:25.727435Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.038033246994018555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_avg_items_per_drink_order_all_day___total_drink_items_ordered_all_day.616d1ab7c6", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(avg_items_per_drink_order_all_day <= total_drink_items_ordered_all_day)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.716423Z", "completed_at": "2025-05-17T21:25:25.724431Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.727435Z", "completed_at": "2025-05-17T21:25:25.727435Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.040036916732788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_avg_revenue_per_drink_order_all_day___0.f3b66c426d", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(avg_revenue_per_drink_order_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.741446Z", "completed_at": "2025-05-17T21:25:25.758462Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.764469Z", "completed_at": "2025-05-17T21:25:25.764469Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03203010559082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_avg_revenue_per_drink_order_all_day___total_daily_drink_revenue.9cec8cd318", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(avg_revenue_per_drink_order_all_day <= total_daily_drink_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.747453Z", "completed_at": "2025-05-17T21:25:25.764469Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.765469Z", "completed_at": "2025-05-17T21:25:25.765469Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03302931785583496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_distinct_drink_tables_all_day___0.2f1ed6c9dd", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(distinct_drink_tables_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.753457Z", "completed_at": "2025-05-17T21:25:25.765469Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.769472Z", "completed_at": "2025-05-17T21:25:25.769472Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.035033226013183594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_drink_category_diversity_all_day___0.841422b2c0", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(drink_category_diversity_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.759463Z", "completed_at": "2025-05-17T21:25:25.767470Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.770473Z", "completed_at": "2025-05-17T21:25:25.770473Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03503227233886719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_top_daily_drink_category_revenue___0.10b8e32fdf", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(top_daily_drink_category_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.783484Z", "completed_at": "2025-05-17T21:25:25.805504Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.807508Z", "completed_at": "2025-05-17T21:25:25.807508Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03403019905090332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_top_daily_drink_category_revenue___total_daily_drink_revenue.f566520520", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(top_daily_drink_category_revenue <= total_daily_drink_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.789490Z", "completed_at": "2025-05-17T21:25:25.807508Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.808507Z", "completed_at": "2025-05-17T21:25:25.808507Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03403043746948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_total_customers_all_day___0.3614fd7ba9", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(total_customers_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.794495Z", "completed_at": "2025-05-17T21:25:25.808507Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.812511Z", "completed_at": "2025-05-17T21:25:25.812511Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03703451156616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_total_daily_drink_revenue___0.999b27f967", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(total_daily_drink_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.801502Z", "completed_at": "2025-05-17T21:25:25.809508Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.815514Z", "completed_at": "2025-05-17T21:25:25.815514Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03903460502624512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_total_drink_items_ordered_all_day___0.0a862aa1bf", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(total_drink_items_ordered_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.826524Z", "completed_at": "2025-05-17T21:25:25.843541Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.849545Z", "completed_at": "2025-05-17T21:25:25.849545Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03303074836730957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_total_drink_orders_all_day___0.0a5caa04e6", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(total_drink_orders_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.832533Z", "completed_at": "2025-05-17T21:25:25.849545Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.851547Z", "completed_at": "2025-05-17T21:25:25.851547Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03402900695800781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_drink_sales_unique_drink_items_ordered_all_day___0.9c7b482cea", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n\nwhere not(unique_drink_items_ordered_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.838535Z", "completed_at": "2025-05-17T21:25:25.850547Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.854549Z", "completed_at": "2025-05-17T21:25:25.854549Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603243827819824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_daily_drink_sales_order_date.a15b02f884", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_date\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\nwhere order_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.844540Z", "completed_at": "2025-05-17T21:25:25.851547Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.856551Z", "completed_at": "2025-05-17T21:25:25.856551Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.038034677505493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_agg_daily_drink_sales_order_date.37388b3ec8", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_date as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n  where order_date is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.869563Z", "completed_at": "2025-05-17T21:25:25.886579Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.892585Z", "completed_at": "2025-05-17T21:25:25.892585Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03202962875366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_daily_total_sales", "compiled": true, "compiled_code": "with food as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n),\n\ndrink as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales`\n),\n\nmetadata as (\n    select\n        order_date,\n        distinct_tables_used_all_day\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_metadata`\n),\n\ncombined as (\n    select\n        f.order_date,\n        extract(dayofweek from f.order_date) as day_of_week,\n        f.total_food_items_sold_all_day as total_food_items,\n        d.total_drink_items_ordered_all_day as total_drink_items,\n        f.total_daily_food_revenue as food_revenue,\n        d.total_daily_drink_revenue as drink_revenue,\n        f.total_customers_all_day as total_daily_customers,\n        f.total_food_orders_all_day as food_orders,\n        d.total_drink_orders_all_day as drink_orders,\n        f.unique_food_items_ordered_all_day as unique_food_items,\n        d.unique_drink_items_ordered_all_day as unique_drink_items,\n        f.food_category_diversity_all_day as food_cat_div,\n        d.drink_category_diversity_all_day as drink_cat_div,\n        case\n            when f.top_daily_food_category_revenue >= d.top_daily_drink_category_revenue then f.top_daily_food_category_name\n            else d.top_daily_drink_category_name\n        end as top_daily_category_name,\n        greatest(f.top_daily_food_category_revenue, d.top_daily_drink_category_revenue) as top_daily_category_revenue,\n        m.distinct_tables_used_all_day\n    from food f\n    join drink d on f.order_date = d.order_date\n    left join metadata m on f.order_date = m.order_date\n),\n\n\npeak_hours_list as (\n    select\n        f.order_date,\n        array_to_string(\n            array(\n                select distinct hour\n                from unnest(\n                    split(coalesce(f.kitchen_peak_hours, '') || ',' || coalesce(d.bar_peak_hours, ''), ',')\n                ) as hour\n                where safe_cast(hour as int) is not null\n                order by cast(hour as int)\n            ), ','\n        ) as peak_hours\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales` f\n    join `annular-mesh-453913-r6`.`dbt_`.`agg_daily_drink_sales` d using (order_date)\n),\n\n\ndaily_totals as (\n    select\n        c.order_date,\n        c.day_of_week,\n        (c.total_food_items + c.total_drink_items) as total_items_ordered_all_day,\n        (c.food_revenue + c.drink_revenue) as total_daily_revenue,\n        round((c.food_revenue + c.drink_revenue) / nullif((c.total_food_items + c.total_drink_items), 0), 2) as avg_revenue_per_item_daily,\n        (c.food_cat_div + c.drink_cat_div) as category_diversity_all_day,\n        c.top_daily_category_name,\n        c.top_daily_category_revenue,\n        round(c.food_revenue / nullif((c.food_revenue + c.drink_revenue), 0), 2) as pct_food_from_daily_revenue,\n        round(c.drink_revenue / nullif((c.food_revenue + c.drink_revenue), 0), 2) as pct_drink_from_daily_revenue,\n        round(c.top_daily_category_revenue / nullif((c.food_revenue + c.drink_revenue), 0), 2) as pct_top_cat_of_total_daily_revenue,\n        c.total_daily_customers,\n        round((c.food_revenue + c.drink_revenue) / nullif(c.total_daily_customers, 0), 2) as avg_daily_revenue_per_head,\n        round((c.total_food_items + c.total_drink_items) / nullif(c.total_daily_customers, 0), 2) as avg_items_ordered_per_head_per_day,\n        (c.food_orders + c.drink_orders) as total_orders_all_day,\n        round((c.total_food_items + c.total_drink_items) / nullif((c.food_orders + c.drink_orders), 0), 2) as avg_items_per_order_all_day,\n        round((c.food_revenue + c.drink_revenue) / nullif((c.food_orders + c.drink_orders), 0), 2) as avg_revenue_per_order_all_day,\n        (c.unique_food_items + c.unique_drink_items) as unique_items_ordered_all_day,\n        c.distinct_tables_used_all_day,\n        extract(dayofweek from c.order_date) in (1, 6, 7) as is_weekend,\n        p.peak_hours\n    from combined c\n    left join peak_hours_list p on c.order_date = p.order_date\n),\n\nrevenue_trends as (\n    select\n        *,\n        round((total_daily_revenue - lag(total_daily_revenue) over (order by order_date)) / nullif(lag(total_daily_revenue) over (order by order_date), 0), 4) as pct_change_in_daily_revenue,\n        round(total_daily_revenue - lag(total_daily_revenue) over (order by order_date), 2) as daily_revenue_change_amount,\n        round(avg(total_daily_revenue) over (order by order_date rows between 6 preceding and current row), 2) as rolling_avg_revenue_7d,\n        round(avg(total_items_ordered_all_day) over (order by order_date rows between 6 preceding and current row), 2) as rolling_avg_items_sold_7d\n    from daily_totals\n)\n\nselect *\nfrom revenue_trends\norder by order_date desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.875569Z", "completed_at": "2025-05-17T21:25:25.892585Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.894586Z", "completed_at": "2025-05-17T21:25:25.894586Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03302907943725586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_monthly_food_sales", "compiled": true, "compiled_code": "with daily as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n),\n\nmetadata as (\n    select\n        order_month,\n        food_category_diversity_all_month,\n        unique_food_items_ordered_all_month\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_metadata`\n),\n\npeak_hours as (\n    select\n        format_date('%Y-%m', order_date) as order_month,\n        array_to_string(array_agg(distinct hour_str order by hour_str), ',') as kitchen_peak_hours_monthly\n    from (\n        select\n            order_date,\n            cast(hour as string) as hour_str\n        from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`,\n        unnest(split(kitchen_peak_hours, ',')) as hour\n    )\n    group by order_month\n),\n\naggregated as (\n    select\n        format_date('%Y-%m', order_date) as order_month,\n        sum(total_food_items_sold_all_day) as total_food_items_sold_monthly,\n        sum(total_daily_food_revenue) as total_monthly_food_revenue,\n        round(sum(total_daily_food_revenue) / nullif(sum(total_food_items_sold_all_day), 0), 2) as avg_monthly_revenue_per_food_item,\n\n        max_by(top_daily_food_category_name, top_daily_food_category_revenue) as top_monthly_food_category_name,\n        max(top_daily_food_category_revenue) as top_monthly_food_category_revenue,\n        round(\n            max(top_daily_food_category_revenue) / nullif(sum(total_daily_food_revenue), 0),\n            2\n        ) as pct_top_food_cat_from_monthly_food_revenue,\n\n        round(avg(distinct_food_tables_all_day), 2) as avg_distinct_food_tables_per_day_monthly,\n        sum(total_food_orders_all_day) as total_food_orders_monthly,\n        round(sum(total_daily_food_revenue) / nullif(sum(total_food_orders_all_day), 0), 2) as avg_revenue_per_food_order_monthly,\n        round(sum(total_food_items_sold_all_day) / nullif(sum(total_food_orders_all_day), 0), 2) as avg_items_per_food_order_monthly,\n\n        sum(total_customers_all_day) as total_customers_monthly,\n        round(sum(total_daily_food_revenue) / nullif(sum(total_customers_all_day), 0), 2) as avg_food_revenue_per_head_monthly,\n        round(sum(total_food_items_sold_all_day) / nullif(sum(total_customers_all_day), 0), 2) as avg_food_items_per_head_monthly\n\n    from daily\n    group by order_month\n)\n\nselect\n    a.order_month,\n    a.total_food_items_sold_monthly,\n    a.total_monthly_food_revenue,\n    a.avg_monthly_revenue_per_food_item,\n    a.top_monthly_food_category_name,\n    a.top_monthly_food_category_revenue,\n    a.pct_top_food_cat_from_monthly_food_revenue,\n    a.avg_distinct_food_tables_per_day_monthly,\n    a.total_food_orders_monthly,\n    a.avg_revenue_per_food_order_monthly,\n    a.avg_items_per_food_order_monthly,\n    a.total_customers_monthly,\n    a.avg_food_revenue_per_head_monthly,\n    a.avg_food_items_per_head_monthly,\n    coalesce(m.food_category_diversity_all_month, 0) as food_category_diversity_monthly,\n    coalesce(m.unique_food_items_ordered_all_month, 0) as unique_food_items_ordered_monthly,\n    p.kitchen_peak_hours_monthly\nfrom aggregated a\nleft join metadata m using (order_month)\nleft join peak_hours p using (order_month)\norder by order_month desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.880573Z", "completed_at": "2025-05-17T21:25:25.893585Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.897588Z", "completed_at": "2025-05-17T21:25:25.897588Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03503131866455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_weekly_food_sales", "compiled": true, "compiled_code": "with daily as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n),\n\nmetadata as (\n    select\n        order_week,\n        food_category_diversity_all_week,\n        unique_food_items_ordered_all_week\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_metadata`\n),\n\npeak_hours as (\n    select\n        format_date('%G-%V', order_date) as order_week,\n        array_to_string(array_agg(distinct hour_str order by hour_str), ',') as kitchen_peak_hours_weekly\n    from (\n        select\n            order_date,\n            cast(hour as string) as hour_str\n        from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`,\n        unnest(split(kitchen_peak_hours, ',')) as hour\n    )\n    group by order_week\n),\n\naggregated as (\n    select\n        format_date('%G-%V', order_date) as order_week,\n        min(order_date) as week_start_date,\n        max(order_date) as week_end_date,\n\n        sum(total_food_items_sold_all_day) as total_food_items_sold_weekly,\n        sum(total_daily_food_revenue) as total_weekly_food_revenue,\n        round(sum(total_daily_food_revenue) / nullif(sum(total_food_items_sold_all_day), 0), 2) as avg_weekly_revenue_per_food_item,\n\n        max_by(top_daily_food_category_name, top_daily_food_category_revenue) as top_weekly_food_category_name,\n        max(top_daily_food_category_revenue) as top_weekly_food_category_revenue,\n        round(max(top_daily_food_category_revenue) / nullif(sum(total_daily_food_revenue), 0), 2) as pct_top_food_cat_from_weekly_food_revenue,\n\n        round(avg(distinct_food_tables_all_day), 2) as avg_distinct_food_tables_per_day_weekly,\n        sum(total_food_orders_all_day) as total_food_orders_weekly,\n        round(sum(total_daily_food_revenue) / nullif(sum(total_food_orders_all_day), 0), 2) as avg_revenue_per_food_order_weekly,\n        round(sum(total_food_items_sold_all_day) / nullif(sum(total_food_orders_all_day), 0), 2) as avg_items_per_food_order_weekly,\n        sum(total_customers_all_day) as total_customers_weekly,\n        round(sum(total_daily_food_revenue) / nullif(sum(total_customers_all_day), 0), 2) as avg_food_revenue_per_head_weekly,\n        round(sum(total_food_items_sold_all_day) / nullif(sum(total_customers_all_day), 0), 2) as avg_food_items_per_head_weekly\n\n    from daily\n    group by order_week\n),\n\nfinal as (\n    select\n        a.*,\n        m.food_category_diversity_all_week as food_category_diversity_weekly,\n        m.unique_food_items_ordered_all_week as unique_food_items_ordered_weekly,\n        p.kitchen_peak_hours_weekly\n    from aggregated a\n    left join metadata m using (order_week)\n    left join peak_hours p using (order_week)\n)\n\nselect *\nfrom final\norder by order_week desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.887580Z", "completed_at": "2025-05-17T21:25:25.894586Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.900591Z", "completed_at": "2025-05-17T21:25:25.900591Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.037033796310424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_daily_food_sales_is_weekend__False__True__False.4a2a5dc77c", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        is_weekend as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n    group by is_weekend\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    True,False\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.912603Z", "completed_at": "2025-05-17T21:25:25.929619Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.935623Z", "completed_at": "2025-05-17T21:25:25.935623Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03203082084655762, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_daily_food_sales_top_daily_food_category_name__Mains__Large_Cuts__Steaks__Cheese__Sides__Sauces__Puddings__Ice_Cream_Sorbet__Extras__Chocolates__Starters.b33fb8893d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        top_daily_food_category_name as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n    group by top_daily_food_category_name\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Mains','Large Cuts','Steaks','Cheese','Sides','Sauces','Puddings','Ice-Cream & Sorbet','Extras','Chocolates','Starters'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.918609Z", "completed_at": "2025-05-17T21:25:25.935623Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.937627Z", "completed_at": "2025-05-17T21:25:25.937627Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.034029483795166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_daily_food_sales_pct_top_food_cat_from_daily_food_revenue__1__0.794f2beb78", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_food_cat_from_daily_food_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_food_cat_from_daily_food_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.924613Z", "completed_at": "2025-05-17T21:25:25.936625Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.940628Z", "completed_at": "2025-05-17T21:25:25.940628Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603315353393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_avg_daily_revenue_per_food_item___0.0a2459d06e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(avg_daily_revenue_per_food_item >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.930618Z", "completed_at": "2025-05-17T21:25:25.938626Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.943631Z", "completed_at": "2025-05-17T21:25:25.943631Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03603243827819824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_avg_food_items_per_head_all_day___0.1013ce16d7", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(avg_food_items_per_head_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.954640Z", "completed_at": "2025-05-17T21:25:25.974658Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.981666Z", "completed_at": "2025-05-17T21:25:25.981666Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03603339195251465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_avg_food_items_per_head_all_day___total_food_items_sold_all_day.5655082675", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(avg_food_items_per_head_all_day <= total_food_items_sold_all_day)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.961647Z", "completed_at": "2025-05-17T21:25:25.980664Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.982667Z", "completed_at": "2025-05-17T21:25:25.982667Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.038034915924072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_avg_food_revenue_per_head_all_day___0.91a6d5c72f", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(avg_food_revenue_per_head_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.967652Z", "completed_at": "2025-05-17T21:25:25.981666Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.984668Z", "completed_at": "2025-05-17T21:25:25.984668Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03903675079345703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_avg_food_revenue_per_head_all_day___total_daily_food_revenue.a81083db0e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(avg_food_revenue_per_head_all_day <= total_daily_food_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:25.975659Z", "completed_at": "2025-05-17T21:25:25.983667Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:25.988672Z", "completed_at": "2025-05-17T21:25:25.988672Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.041037797927856445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_avg_items_per_food_order_all_day___1.aa27ff7b31", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(avg_items_per_food_order_all_day >= 1)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.001684Z", "completed_at": "2025-05-17T21:25:26.022702Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.023704Z", "completed_at": "2025-05-17T21:25:26.023704Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031026363372802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_avg_items_per_food_order_all_day___total_food_items_sold_all_day.0ddf9da8c2", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(avg_items_per_food_order_all_day <= total_food_items_sold_all_day)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.006687Z", "completed_at": "2025-05-17T21:25:26.022702Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.025706Z", "completed_at": "2025-05-17T21:25:26.025706Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03502988815307617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_avg_revenue_per_food_order_all_day___0.2e1f57b14e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(avg_revenue_per_food_order_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.011693Z", "completed_at": "2025-05-17T21:25:26.024704Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.028708Z", "completed_at": "2025-05-17T21:25:26.028708Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603315353393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_avg_revenue_per_food_order_all_day___total_daily_food_revenue.f0b464756f", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(avg_revenue_per_food_order_all_day <= total_daily_food_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.017698Z", "completed_at": "2025-05-17T21:25:26.025706Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.029710Z", "completed_at": "2025-05-17T21:25:26.029710Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03703427314758301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_distinct_food_tables_all_day___0.d18f978716", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(distinct_food_tables_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.042720Z", "completed_at": "2025-05-17T21:25:26.065741Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.067744Z", "completed_at": "2025-05-17T21:25:26.067744Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034030914306640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_food_category_diversity_all_day___0.b5412e1e33", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(food_category_diversity_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.048727Z", "completed_at": "2025-05-17T21:25:26.066742Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.068745Z", "completed_at": "2025-05-17T21:25:26.068745Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.035031795501708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_top_daily_food_category_revenue___0.f8dcedd1db", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(top_daily_food_category_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.053730Z", "completed_at": "2025-05-17T21:25:26.067744Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.072748Z", "completed_at": "2025-05-17T21:25:26.072748Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03803610801696777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_top_daily_food_category_revenue___total_daily_food_revenue.0cd87cbf08", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(top_daily_food_category_revenue <= total_daily_food_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.060738Z", "completed_at": "2025-05-17T21:25:26.069745Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.075750Z", "completed_at": "2025-05-17T21:25:26.075750Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.039034366607666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_total_customers_all_day___0.839c694190", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(total_customers_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.086761Z", "completed_at": "2025-05-17T21:25:26.102776Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.109782Z", "completed_at": "2025-05-17T21:25:26.109782Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.032030344009399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_total_daily_food_revenue___0.675f634dc2", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(total_daily_food_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.091765Z", "completed_at": "2025-05-17T21:25:26.108780Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.110784Z", "completed_at": "2025-05-17T21:25:26.110784Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03403186798095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_total_food_items_sold_all_day___0.e94072a7cb", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(total_food_items_sold_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.097771Z", "completed_at": "2025-05-17T21:25:26.110784Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.111783Z", "completed_at": "2025-05-17T21:25:26.111783Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03310513496398926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_total_food_orders_all_day___0.6ef55829f2", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(total_food_orders_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.103777Z", "completed_at": "2025-05-17T21:25:26.111783Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.116787Z", "completed_at": "2025-05-17T21:25:26.116787Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03610587120056152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_food_sales_unique_food_items_ordered_all_day___0.3716d579f5", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n\nwhere not(unique_food_items_ordered_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.127872Z", "completed_at": "2025-05-17T21:25:26.149891Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.151893Z", "completed_at": "2025-05-17T21:25:26.151893Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03102731704711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_daily_food_sales_order_date.1329693b01", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_date\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\nwhere order_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.132876Z", "completed_at": "2025-05-17T21:25:26.150893Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.152894Z", "completed_at": "2025-05-17T21:25:26.152894Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03403043746948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_agg_daily_food_sales_order_date.e87d78ab38", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_date as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_food_sales`\n  where order_date is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.137881Z", "completed_at": "2025-05-17T21:25:26.151893Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.155897Z", "completed_at": "2025-05-17T21:25:26.155897Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03703427314758301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_hourly_total_sales_is_peak_hour__False__True__False.a383e22e95", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        is_peak_hour as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n    group by is_peak_hour\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    True,False\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.143886Z", "completed_at": "2025-05-17T21:25:26.152894Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.158899Z", "completed_at": "2025-05-17T21:25:26.158899Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0370330810546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_hourly_total_sales_is_weekend__False__True__False.c8919b8fab", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        is_weekend as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n    group by is_weekend\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    True,False\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.170003Z", "completed_at": "2025-05-17T21:25:26.187018Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.193024Z", "completed_at": "2025-05-17T21:25:26.193024Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03212332725524902, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_hourly_total_sales_hour_of_day__23__0.a164d43343", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not hour_of_day >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not hour_of_day <= 23\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.175008Z", "completed_at": "2025-05-17T21:25:26.192023Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.195027Z", "completed_at": "2025-05-17T21:25:26.195027Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0351259708404541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_hourly_total_sales_pct_drink_revenue_per_hour__1__0.6205b4143a", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_drink_revenue_per_hour >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_drink_revenue_per_hour <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.182014Z", "completed_at": "2025-05-17T21:25:26.194027Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.198029Z", "completed_at": "2025-05-17T21:25:26.198029Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0350954532623291, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_hourly_total_sales_pct_food_revenue_per_hour__1__0.d3cf0985ff", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_food_revenue_per_hour >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_food_revenue_per_hour <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.187018Z", "completed_at": "2025-05-17T21:25:26.195027Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.199031Z", "completed_at": "2025-05-17T21:25:26.199031Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03703188896179199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_hourly_total_sales_pct_top_cat_of_total_revenue_per_hour__1__0.e9c1cb9011", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_cat_of_total_revenue_per_hour >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_cat_of_total_revenue_per_hour <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.212042Z", "completed_at": "2025-05-17T21:25:26.229056Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.236063Z", "completed_at": "2025-05-17T21:25:26.236063Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03403067588806152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_avg_items_ordered_per_head_per_hour___0.9e7dc2a3af", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(avg_items_ordered_per_head_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.217046Z", "completed_at": "2025-05-17T21:25:26.236063Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.238066Z", "completed_at": "2025-05-17T21:25:26.238066Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.035030364990234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_avg_items_per_order_per_hour___1.c414496d06", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(avg_items_per_order_per_hour >= 1)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.223051Z", "completed_at": "2025-05-17T21:25:26.237064Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.239066Z", "completed_at": "2025-05-17T21:25:26.239066Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603410720825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_avg_items_per_order_per_hour___total_items_ordered_per_hour.f026e27c1b", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(avg_items_per_order_per_hour <= total_items_ordered_per_hour)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.229056Z", "completed_at": "2025-05-17T21:25:26.238066Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.244072Z", "completed_at": "2025-05-17T21:25:26.244072Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.038034677505493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_avg_revenue_per_head_per_hour___0.d9780ac8b5", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(avg_revenue_per_head_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.255082Z", "completed_at": "2025-05-17T21:25:26.277103Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.278103Z", "completed_at": "2025-05-17T21:25:26.278103Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03202962875366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_avg_revenue_per_item_per_hour___0.2da1f4aa0c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(avg_revenue_per_item_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.260085Z", "completed_at": "2025-05-17T21:25:26.278103Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.280103Z", "completed_at": "2025-05-17T21:25:26.280103Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03403210639953613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_avg_revenue_per_item_per_hour___total_revenue_per_hour.92ca689742", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(avg_revenue_per_item_per_hour <= total_revenue_per_hour)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.266090Z", "completed_at": "2025-05-17T21:25:26.279103Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.283106Z", "completed_at": "2025-05-17T21:25:26.283106Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603482246398926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_avg_revenue_per_order_per_hour___0.6291f71cf1", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(avg_revenue_per_order_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.272097Z", "completed_at": "2025-05-17T21:25:26.280103Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.285109Z", "completed_at": "2025-05-17T21:25:26.285109Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03603315353393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_avg_revenue_per_order_per_hour___total_revenue_per_hour.25d1529a32", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(avg_revenue_per_order_per_hour <= total_revenue_per_hour)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.297119Z", "completed_at": "2025-05-17T21:25:26.319139Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.320140Z", "completed_at": "2025-05-17T21:25:26.320140Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03402996063232422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_category_diversity_per_hour___1.e51151b9dc", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(category_diversity_per_hour >= 1)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.303124Z", "completed_at": "2025-05-17T21:25:26.320140Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.321141Z", "completed_at": "2025-05-17T21:25:26.321141Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.036031484603881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_distinct_tables_per_hour___0.7b7e4b646d", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(distinct_tables_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.308129Z", "completed_at": "2025-05-17T21:25:26.321141Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.327147Z", "completed_at": "2025-05-17T21:25:26.327147Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03703474998474121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_distinct_tables_per_hour___50.0ba73e9b1e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(distinct_tables_per_hour <= 50)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.314134Z", "completed_at": "2025-05-17T21:25:26.322142Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.329148Z", "completed_at": "2025-05-17T21:25:26.329148Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03903508186340332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_top_category_revenue_per_hour___0.6b3387f990", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(top_category_revenue_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.339157Z", "completed_at": "2025-05-17T21:25:26.352168Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.363178Z", "completed_at": "2025-05-17T21:25:26.363178Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.032030344009399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_top_category_revenue_per_hour___total_revenue_per_hour.a785668cfe", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(top_category_revenue_per_hour <= total_revenue_per_hour)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.346165Z", "completed_at": "2025-05-17T21:25:26.363178Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.367182Z", "completed_at": "2025-05-17T21:25:26.367182Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03503227233886719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_total_items_ordered_per_hour___0.a6ec55afbf", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(total_items_ordered_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.352168Z", "completed_at": "2025-05-17T21:25:26.365181Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.368184Z", "completed_at": "2025-05-17T21:25:26.368184Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.036034584045410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_total_new_customers_per_hour___0.05f359783c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(total_new_customers_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.358174Z", "completed_at": "2025-05-17T21:25:26.368184Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.370185Z", "completed_at": "2025-05-17T21:25:26.370185Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.031027793884277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_total_orders_per_hour___0.dbaea66183", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(total_orders_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.381196Z", "completed_at": "2025-05-17T21:25:26.394207Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.404216Z", "completed_at": "2025-05-17T21:25:26.404216Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.033028602600097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_total_revenue_per_hour___0.b50fc0b8bb", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(total_revenue_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.389202Z", "completed_at": "2025-05-17T21:25:26.404216Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.409221Z", "completed_at": "2025-05-17T21:25:26.409221Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03303027153015137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_hourly_total_sales_unique_items_ordered_per_hour___0.b1f25f6421", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n\nwhere not(unique_items_ordered_per_hour >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.394207Z", "completed_at": "2025-05-17T21:25:26.406218Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.409221Z", "completed_at": "2025-05-17T21:25:26.409221Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03403210639953613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_hourly_total_sales_hour_of_day.1d078c6715", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect hour_of_day\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\nwhere hour_of_day is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.399213Z", "completed_at": "2025-05-17T21:25:26.408220Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.410222Z", "completed_at": "2025-05-17T21:25:26.410222Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03303122520446777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_hourly_total_sales_order_date.3f19fbb9cc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_date\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\nwhere order_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.423234Z", "completed_at": "2025-05-17T21:25:26.435244Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.446254Z", "completed_at": "2025-05-17T21:25:26.446254Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03603243827819824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_hourly_total_sales_order_hour_dt.97b59b9388", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_hour_dt\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\nwhere order_hour_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.431242Z", "completed_at": "2025-05-17T21:25:26.447255Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.449257Z", "completed_at": "2025-05-17T21:25:26.449257Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03203010559082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_agg_hourly_total_sales_order_hour_dt.e9ebac77c1", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_hour_dt as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_hourly_total_sales`\n  where order_hour_dt is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.436246Z", "completed_at": "2025-05-17T21:25:26.448256Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.452260Z", "completed_at": "2025-05-17T21:25:26.452260Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03403210639953613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_monthly_drink_sales_top_monthly_drink_category_name__Beers_Cider__Lo_No_Alc__Port_Sherry__Ultimate_Steakhouse_Cocktails__Time_A_Place__Rarities__The_Sacred_Six__Red_Wines__Champagne_Sparkling__Rose_Wines__Dessert_Wines__White_Wines__Magnums__Bordeaux__Burgundy.e9ff30fcb1", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        top_monthly_drink_category_name as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n    group by top_monthly_drink_category_name\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Beers & Cider','Lo & No Alc','Port & Sherry','Ultimate Steakhouse Cocktails','Time & A Place','Rarities','The Sacred Six','Red Wines','Champagne & Sparkling','Rose Wines','Dessert Wines','White Wines','Magnums','Bordeaux','Burgundy'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.441251Z", "completed_at": "2025-05-17T21:25:26.450258Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.454262Z", "completed_at": "2025-05-17T21:25:26.454262Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.031028032302856445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_monthly_drink_sales_pct_top_drink_cat_from_monthly_drinks_revenue__1__0.8a660dc628", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_drink_cat_from_monthly_drinks_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_drink_cat_from_monthly_drinks_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.465272Z", "completed_at": "2025-05-17T21:25:26.487291Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.489294Z", "completed_at": "2025-05-17T21:25:26.489294Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03202939033508301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_avg_distinct_drink_tables_per_day_monthly___0.d7cb5d4d53", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(avg_distinct_drink_tables_per_day_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.472278Z", "completed_at": "2025-05-17T21:25:26.488294Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.490296Z", "completed_at": "2025-05-17T21:25:26.490296Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.033028602600097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_avg_drink_items_per_head_monthly___0.566b981669", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(avg_drink_items_per_head_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.477283Z", "completed_at": "2025-05-17T21:25:26.489294Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.493297Z", "completed_at": "2025-05-17T21:25:26.493297Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.035031795501708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_avg_drink_items_per_head_monthly___total_drink_items_sold_monthly.1c96391e40", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(avg_drink_items_per_head_monthly <= total_drink_items_sold_monthly)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.482288Z", "completed_at": "2025-05-17T21:25:26.491296Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.496299Z", "completed_at": "2025-05-17T21:25:26.496299Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03803420066833496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_avg_drinks_revenue_per_head_monthly___0.bc9852b7ff", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(avg_drinks_revenue_per_head_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.508311Z", "completed_at": "2025-05-17T21:25:26.528330Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.534335Z", "completed_at": "2025-05-17T21:25:26.534335Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03603386878967285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_avg_drinks_revenue_per_head_monthly___total_monthly_drink_revenue.239e569194", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(avg_drinks_revenue_per_head_monthly <= total_monthly_drink_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.517320Z", "completed_at": "2025-05-17T21:25:26.534335Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.536337Z", "completed_at": "2025-05-17T21:25:26.536337Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0370330810546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_avg_items_per_drinks_order_monthly___1.f0b829bc3b", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(avg_items_per_drinks_order_monthly >= 1)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.523325Z", "completed_at": "2025-05-17T21:25:26.535336Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.538338Z", "completed_at": "2025-05-17T21:25:26.538338Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03803515434265137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_avg_items_per_drinks_order_monthly___total_drink_items_sold_monthly.ff447dc7ce", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(avg_items_per_drinks_order_monthly <= total_drink_items_sold_monthly)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.529330Z", "completed_at": "2025-05-17T21:25:26.537337Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.542341Z", "completed_at": "2025-05-17T21:25:26.542341Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04003643989562988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_avg_monthly_revenue_per_drink_item___0.ae46762f96", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(avg_monthly_revenue_per_drink_item >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.553352Z", "completed_at": "2025-05-17T21:25:26.575371Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.577373Z", "completed_at": "2025-05-17T21:25:26.577373Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0320284366607666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_avg_monthly_revenue_per_drink_item___total_monthly_drink_revenue.0b375d7a1a", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(avg_monthly_revenue_per_drink_item <= total_monthly_drink_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.558357Z", "completed_at": "2025-05-17T21:25:26.576373Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.578374Z", "completed_at": "2025-05-17T21:25:26.578374Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03503084182739258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_avg_revenue_per_drinks_order_monthly___0.437465dbf8", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(avg_revenue_per_drinks_order_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.564362Z", "completed_at": "2025-05-17T21:25:26.576373Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.579376Z", "completed_at": "2025-05-17T21:25:26.579376Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.035031795501708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_avg_revenue_per_drinks_order_monthly___total_monthly_drink_revenue.358e708571", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(avg_revenue_per_drinks_order_monthly <= total_monthly_drink_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.570367Z", "completed_at": "2025-05-17T21:25:26.578374Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.582378Z", "completed_at": "2025-05-17T21:25:26.582378Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0370330810546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_drink_category_diversity_monthly___0.6fd0308aab", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(drink_category_diversity_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.595391Z", "completed_at": "2025-05-17T21:25:26.618411Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.620413Z", "completed_at": "2025-05-17T21:25:26.620413Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03303050994873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_top_monthly_drink_category_revenue___0.544c494439", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(top_monthly_drink_category_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.602396Z", "completed_at": "2025-05-17T21:25:26.619413Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.621413Z", "completed_at": "2025-05-17T21:25:26.621413Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03503227233886719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_top_monthly_drink_category_revenue___total_monthly_drink_revenue.f7ff55af58", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(top_monthly_drink_category_revenue <= total_monthly_drink_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.607401Z", "completed_at": "2025-05-17T21:25:26.620413Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.624416Z", "completed_at": "2025-05-17T21:25:26.624416Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.037035465240478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_total_customers_monthly___0.a585e5c44e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(total_customers_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.613407Z", "completed_at": "2025-05-17T21:25:26.621413Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.627420Z", "completed_at": "2025-05-17T21:25:26.627420Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03903555870056152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_total_drink_items_sold_monthly___0.a0a68903fd", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(total_drink_items_sold_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.637428Z", "completed_at": "2025-05-17T21:25:26.655446Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.661451Z", "completed_at": "2025-05-17T21:25:26.661451Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03302955627441406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_total_drink_orders_monthly___0.aba693124d", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(total_drink_orders_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.644435Z", "completed_at": "2025-05-17T21:25:26.662451Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.666455Z", "completed_at": "2025-05-17T21:25:26.666455Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03603196144104004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_total_monthly_drink_revenue___0.29fee5e19e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(total_monthly_drink_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.650441Z", "completed_at": "2025-05-17T21:25:26.663452Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.667457Z", "completed_at": "2025-05-17T21:25:26.667457Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03703474998474121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_drink_sales_unique_drink_items_ordered_monthly___0.709e843536", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n\nwhere not(unique_drink_items_ordered_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.655446Z", "completed_at": "2025-05-17T21:25:26.664452Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.667457Z", "completed_at": "2025-05-17T21:25:26.667457Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03303098678588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_monthly_drink_sales_order_month.d637a64958", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_month\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\nwhere order_month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.681469Z", "completed_at": "2025-05-17T21:25:26.699486Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.705490Z", "completed_at": "2025-05-17T21:25:26.705490Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03303074836730957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_agg_monthly_drink_sales_order_month.319cf0cf13", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_month as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n  where order_month is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.688474Z", "completed_at": "2025-05-17T21:25:26.706491Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.710495Z", "completed_at": "2025-05-17T21:25:26.710495Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.035032033920288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_weekly_drink_sales_top_weekly_drink_category_name__Beers_Cider__Lo_No_Alc__Port_Sherry__Ultimate_Steakhouse_Cocktails__Time_A_Place__Rarities__The_Sacred_Six__Red_Wines__Champagne_Sparkling__Rose_Wines__Dessert_Wines__White_Wines__Magnums__Bordeaux__Burgundy.cdf9d9f4f1", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        top_weekly_drink_category_name as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n    group by top_weekly_drink_category_name\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Beers & Cider','Lo & No Alc','Port & Sherry','Ultimate Steakhouse Cocktails','Time & A Place','Rarities','The Sacred Six','Red Wines','Champagne & Sparkling','Rose Wines','Dessert Wines','White Wines','Magnums','Bordeaux','Burgundy'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.694481Z", "completed_at": "2025-05-17T21:25:26.707493Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.711497Z", "completed_at": "2025-05-17T21:25:26.711497Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603363037109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_weekly_drink_sales_pct_top_drink_cat_from_weekly_drink_revenue__1__0.85a532dcc0", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_drink_cat_from_weekly_drink_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_drink_cat_from_weekly_drink_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.700486Z", "completed_at": "2025-05-17T21:25:26.707493Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.711497Z", "completed_at": "2025-05-17T21:25:26.711497Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03803443908691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_avg_distinct_drink_tables_per_day_weekly___0.f7d3c3caa8", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(avg_distinct_drink_tables_per_day_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.724509Z", "completed_at": "2025-05-17T21:25:26.742525Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.749532Z", "completed_at": "2025-05-17T21:25:26.749532Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03303050994873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_avg_drink_items_per_haed_weekly___0.c8cffabb92", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(avg_drink_items_per_haed_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.731515Z", "completed_at": "2025-05-17T21:25:26.749532Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.753534Z", "completed_at": "2025-05-17T21:25:26.753534Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03503131866455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_avg_drink_items_per_haed_weekly___total_drink_items_sold_weekly.6f9c841a8b", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(avg_drink_items_per_haed_weekly <= total_drink_items_sold_weekly)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.737519Z", "completed_at": "2025-05-17T21:25:26.750531Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.754535Z", "completed_at": "2025-05-17T21:25:26.754535Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603386878967285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_avg_drink_revenue_per_head_weekly___0.5f892929b2", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(avg_drink_revenue_per_head_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.742525Z", "completed_at": "2025-05-17T21:25:26.753534Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.756536Z", "completed_at": "2025-05-17T21:25:26.756536Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03803420066833496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_avg_drink_revenue_per_head_weekly___total_weekly_drink_revenue.9631b34c8b", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(avg_drink_revenue_per_head_weekly <= total_weekly_drink_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.766547Z", "completed_at": "2025-05-17T21:25:26.781559Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.792569Z", "completed_at": "2025-05-17T21:25:26.792569Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03503060340881348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_avg_items_per_drink_order_weekly___0.10253eff42", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(avg_items_per_drink_order_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.774552Z", "completed_at": "2025-05-17T21:25:26.793571Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.797574Z", "completed_at": "2025-05-17T21:25:26.797574Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03603315353393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_avg_items_per_drink_order_weekly___total_drink_items_sold_weekly.bd03606c80", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(avg_items_per_drink_order_weekly <= total_drink_items_sold_weekly)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.781559Z", "completed_at": "2025-05-17T21:25:26.796573Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.798575Z", "completed_at": "2025-05-17T21:25:26.798575Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.038034677505493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_avg_revenue_per_drink_order_weekly___0.9f262fe41f", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(avg_revenue_per_drink_order_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.787565Z", "completed_at": "2025-05-17T21:25:26.798575Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.802579Z", "completed_at": "2025-05-17T21:25:26.802579Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.035032033920288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_avg_revenue_per_drink_order_weekly___total_weekly_drink_revenue.949dd447b7", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(avg_revenue_per_drink_order_weekly <= total_weekly_drink_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.808584Z", "completed_at": "2025-05-17T21:25:26.817592Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.824598Z", "completed_at": "2025-05-17T21:25:26.824598Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0320286750793457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_avg_weekly_revenue_per_drink_item___0.86d5dfbd30", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(avg_weekly_revenue_per_drink_item >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.819593Z", "completed_at": "2025-05-17T21:25:26.838612Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.840613Z", "completed_at": "2025-05-17T21:25:26.840613Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.031028032302856445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_drink_category_diversity_weekly___0.70f3b4ea29", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(drink_category_diversity_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.825600Z", "completed_at": "2025-05-17T21:25:26.840613Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.842615Z", "completed_at": "2025-05-17T21:25:26.842615Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03703498840332031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_top_weekly_drink_category_revenue___0.5a8808ee7f", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(top_weekly_drink_category_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.833607Z", "completed_at": "2025-05-17T21:25:26.841615Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.845618Z", "completed_at": "2025-05-17T21:25:26.845618Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.038034915924072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_top_weekly_drink_category_revenue___total_weekly_drink_revenue.67fe76cbce", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(top_weekly_drink_category_revenue <= total_weekly_drink_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.846619Z", "completed_at": "2025-05-17T21:25:26.857630Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.860632Z", "completed_at": "2025-05-17T21:25:26.860632Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029025793075561523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_total_customers_weekly___0.95963f5647", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(total_customers_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.861633Z", "completed_at": "2025-05-17T21:25:26.882651Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.884654Z", "completed_at": "2025-05-17T21:25:26.884654Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03102707862854004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_total_drink_items_sold_weekly___0.029ac1d01c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(total_drink_items_sold_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.871641Z", "completed_at": "2025-05-17T21:25:26.883653Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.886655Z", "completed_at": "2025-05-17T21:25:26.886655Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03803539276123047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_total_drink_orders_weekly___0.89fcff72dc", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(total_drink_orders_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.877647Z", "completed_at": "2025-05-17T21:25:26.885654Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.894662Z", "completed_at": "2025-05-17T21:25:26.894662Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04003477096557617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_total_weekly_drink_revenue___0.4e8f3101f5", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(total_weekly_drink_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.889658Z", "completed_at": "2025-05-17T21:25:26.900667Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.903671Z", "completed_at": "2025-05-17T21:25:26.903671Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028023958206176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_drink_sales_unique_drink_items_ordered_weekly___0.f1407f0393", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n\nwhere not(unique_drink_items_ordered_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.906674Z", "completed_at": "2025-05-17T21:25:26.918684Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.925691Z", "completed_at": "2025-05-17T21:25:26.925691Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.028025388717651367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_weekly_drink_sales_order_week.5938019729", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_week\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\nwhere order_week is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.912679Z", "completed_at": "2025-05-17T21:25:26.924689Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.926692Z", "completed_at": "2025-05-17T21:25:26.926692Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029026269912719727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_agg_weekly_drink_sales_order_week.ca32244b37", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_week as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n  where order_week is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.919685Z", "completed_at": "2025-05-17T21:25:26.927692Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.936700Z", "completed_at": "2025-05-17T21:25:26.936700Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03603315353393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_daily_total_sales_is_weekend__False__True__False.3f08010b07", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        is_weekend as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n    group by is_weekend\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    True,False\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.931697Z", "completed_at": "2025-05-17T21:25:26.941705Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.944708Z", "completed_at": "2025-05-17T21:25:26.944708Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028027057647705078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_daily_total_sales_day_of_week__7__1.2a85a6b60a", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not day_of_week >= 1\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not day_of_week <= 7\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.945710Z", "completed_at": "2025-05-17T21:25:26.961724Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.968730Z", "completed_at": "2025-05-17T21:25:26.968730Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.031028032302856445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_daily_total_sales_pct_drink_from_daily_revenue__1__0.2b7a44dd8f", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_drink_from_daily_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_drink_from_daily_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.953716Z", "completed_at": "2025-05-17T21:25:26.967729Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.969730Z", "completed_at": "2025-05-17T21:25:26.969730Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03703451156616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_daily_total_sales_pct_food_from_daily_revenue__1__0.7d0a52baea", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_food_from_daily_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_food_from_daily_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.962725Z", "completed_at": "2025-05-17T21:25:26.970731Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.980741Z", "completed_at": "2025-05-17T21:25:26.980741Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.039034366607666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_daily_total_sales_pct_top_cat_of_total_daily_revenue__1__0.2ff363d3b5", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_cat_of_total_daily_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_cat_of_total_daily_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.973734Z", "completed_at": "2025-05-17T21:25:26.982743Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:26.986746Z", "completed_at": "2025-05-17T21:25:26.986746Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023021221160888672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_avg_daily_revenue_per_head___0.243d003451", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(avg_daily_revenue_per_head >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.991750Z", "completed_at": "2025-05-17T21:25:27.005763Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.013771Z", "completed_at": "2025-05-17T21:25:27.013771Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03603219985961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_avg_daily_revenue_per_head___total_daily_revenue.414af5654e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(avg_daily_revenue_per_head  <= total_daily_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:26.997756Z", "completed_at": "2025-05-17T21:25:27.012770Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.014773Z", "completed_at": "2025-05-17T21:25:27.014773Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.037035465240478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_avg_items_ordered_per_head_per_day___0.a0dbf27d44", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(avg_items_ordered_per_head_per_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.005763Z", "completed_at": "2025-05-17T21:25:27.019776Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.024782Z", "completed_at": "2025-05-17T21:25:27.024782Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.038034915924072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_avg_items_ordered_per_head_per_day___total_items_ordered_all_day.7fb1a4a554", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(avg_items_ordered_per_head_per_day  <= total_items_ordered_all_day)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.014773Z", "completed_at": "2025-05-17T21:25:27.026783Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.030787Z", "completed_at": "2025-05-17T21:25:27.030787Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03002643585205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_avg_items_per_order_all_day___0.803711bc28", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(avg_items_per_order_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.035791Z", "completed_at": "2025-05-17T21:25:27.048803Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.057810Z", "completed_at": "2025-05-17T21:25:27.057810Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0370335578918457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_avg_items_per_order_all_day___total_items_ordered_all_day.5d4e1eff4e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(avg_items_per_order_all_day  <= total_items_ordered_all_day)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.041796Z", "completed_at": "2025-05-17T21:25:27.056810Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.063816Z", "completed_at": "2025-05-17T21:25:27.063816Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.037125587463378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_avg_revenue_per_item_daily___0.0a799e5a02", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(avg_revenue_per_item_daily >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.049804Z", "completed_at": "2025-05-17T21:25:27.063816Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.069913Z", "completed_at": "2025-05-17T21:25:27.069913Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03312206268310547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_avg_revenue_per_order_all_day___0.4f58090e30", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(avg_revenue_per_order_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.057810Z", "completed_at": "2025-05-17T21:25:27.068913Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.071916Z", "completed_at": "2025-05-17T21:25:27.071916Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030118703842163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_avg_revenue_per_order_all_day___total_daily_revenue.a17649f776", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(avg_revenue_per_order_all_day  <= total_daily_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.080923Z", "completed_at": "2025-05-17T21:25:27.093442Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.105453Z", "completed_at": "2025-05-17T21:25:27.105453Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03453969955444336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_category_diversity_all_day___0.1ca659ed1c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(category_diversity_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.086467Z", "completed_at": "2025-05-17T21:25:27.099448Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.106454Z", "completed_at": "2025-05-17T21:25:27.106454Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03754305839538574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_distinct_tables_used_all_day___0.05fe3c453a", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(distinct_tables_used_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.093442Z", "completed_at": "2025-05-17T21:25:27.107454Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.110458Z", "completed_at": "2025-05-17T21:25:27.110458Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03453874588012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_pct_top_cat_of_total_daily_revenue___1.a09bb8f229", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(pct_top_cat_of_total_daily_revenue  <= 1)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.100450Z", "completed_at": "2025-05-17T21:25:27.108456Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.112460Z", "completed_at": "2025-05-17T21:25:27.112460Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028025388717651367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_top_daily_category_revenue___0.fd396355d4", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(top_daily_category_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.123469Z", "completed_at": "2025-05-17T21:25:27.142486Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.149493Z", "completed_at": "2025-05-17T21:25:27.149493Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03503060340881348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_top_daily_category_revenue___total_daily_revenue.df013c83bf", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(top_daily_category_revenue  <= total_daily_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.129475Z", "completed_at": "2025-05-17T21:25:27.148493Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.150494Z", "completed_at": "2025-05-17T21:25:27.150494Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0370328426361084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_total_daily_customers___0.80895610fe", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(total_daily_customers >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.135481Z", "completed_at": "2025-05-17T21:25:27.149493Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.154497Z", "completed_at": "2025-05-17T21:25:27.154497Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.039035797119140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_total_daily_revenue___0.97f8e801b5", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(total_daily_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.142486Z", "completed_at": "2025-05-17T21:25:27.151495Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.155498Z", "completed_at": "2025-05-17T21:25:27.155498Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03603172302246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_total_items_ordered_all_day___0.a9751926bd", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(total_items_ordered_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.171513Z", "completed_at": "2025-05-17T21:25:27.187530Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.194537Z", "completed_at": "2025-05-17T21:25:27.194537Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03403520584106445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_total_orders_all_day___0.f985e839f1", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(total_orders_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.177519Z", "completed_at": "2025-05-17T21:25:27.193537Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.195538Z", "completed_at": "2025-05-17T21:25:27.195538Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03503584861755371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_daily_total_sales_unique_items_ordered_all_day___0.999c2652e5", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n\nwhere not(unique_items_ordered_all_day >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.183524Z", "completed_at": "2025-05-17T21:25:27.194537Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.198541Z", "completed_at": "2025-05-17T21:25:27.198541Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03603649139404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_daily_total_sales_order_date.30f5911338", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_date\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\nwhere order_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.188533Z", "completed_at": "2025-05-17T21:25:27.196539Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.199542Z", "completed_at": "2025-05-17T21:25:27.199542Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03603625297546387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_agg_daily_total_sales_order_date.25284edde9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_date as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_daily_total_sales`\n  where order_date is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.212554Z", "completed_at": "2025-05-17T21:25:27.235575Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.237577Z", "completed_at": "2025-05-17T21:25:27.237577Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03403139114379883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_monthly_total_sales", "compiled": true, "compiled_code": "\n\nwith food as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n),\n\ndrink as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_drink_sales`\n),\n\nmetadata as (\n    select\n        order_month,\n        weekend_days_in_month,\n        unique_items_ordered_all_month,\n        food_category_diversity_all_month,\n        drink_category_diversity_all_month\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_metadata`\n),\n\ncombined as (\n    select\n        f.order_month,\n        \n        f.total_food_items_sold_monthly + d.total_drink_items_sold_monthly as total_items_ordered_monthly,\n        f.total_monthly_food_revenue + d.total_monthly_drink_revenue as total_monthly_revenue,\n        \n        round(\n            (f.total_monthly_food_revenue + d.total_monthly_drink_revenue) /\n            nullif(f.total_food_items_sold_monthly + d.total_drink_items_sold_monthly, 0), 2\n        ) as avg_revenue_per_item_monthly,\n\n        f.food_category_diversity_monthly + d.drink_category_diversity_monthly as category_diversity_monthly,\n\n        case\n            when f.top_monthly_food_category_revenue >= d.top_monthly_drink_category_revenue\n                then f.top_monthly_food_category_name\n            else d.top_monthly_drink_category_name\n        end as top_monthly_category_name,\n\n        greatest(f.top_monthly_food_category_revenue, d.top_monthly_drink_category_revenue) as top_monthly_category_revenue,\n\n        round(f.total_monthly_food_revenue / nullif(f.total_monthly_food_revenue + d.total_monthly_drink_revenue, 0), 2) as pct_food_from_monthly_revenue,\n        round(d.total_monthly_drink_revenue / nullif(f.total_monthly_food_revenue + d.total_monthly_drink_revenue, 0), 2) as pct_drink_from_monthly_revenue,\n        round(\n            greatest(f.top_monthly_food_category_revenue, d.top_monthly_drink_category_revenue) /\n            nullif(f.total_monthly_food_revenue + d.total_monthly_drink_revenue, 0), 2\n        ) as pct_top_cat_of_total_monthly_revenue,\n\n        f.total_customers_monthly as total_monthly_customers,\n        round((f.total_monthly_food_revenue + d.total_monthly_drink_revenue) / nullif(f.total_customers_monthly, 0), 2) as avg_monthly_revenue_per_head,\n        round((f.total_food_items_sold_monthly + d.total_drink_items_sold_monthly) / nullif(f.total_customers_monthly, 0), 2) as avg_items_ordered_per_head_monthly,\n\n        f.total_food_orders_monthly + d.total_drink_orders_monthly as total_orders_monthly,\n        round((f.total_food_items_sold_monthly + d.total_drink_items_sold_monthly) / nullif((f.total_food_orders_monthly + d.total_drink_orders_monthly), 0), 2) as avg_items_per_order_monthly,\n        round((f.total_monthly_food_revenue + d.total_monthly_drink_revenue) / nullif((f.total_food_orders_monthly + d.total_drink_orders_monthly), 0), 2) as avg_revenue_per_order_monthly,\n\n        m.unique_items_ordered_all_month as unique_items_ordered_monthly,\n        round((f.avg_distinct_food_tables_per_day_monthly + d.avg_distinct_drink_tables_per_day_monthly) / 2, 2) as avg_distinct_tables_per_day_monthly,\n\n        m.weekend_days_in_month\n\n    from food f\n    join drink d using (order_month)\n    left join metadata m using (order_month)\n),\n\nfinal as (\n    select\n        *,\n        round(total_monthly_revenue - lag(total_monthly_revenue) over (order by order_month), 2) as monthly_revenue_change_amount,\n        round(\n            (total_monthly_revenue - lag(total_monthly_revenue) over (order by order_month)) /\n            nullif(lag(total_monthly_revenue) over (order by order_month), 0), 4\n        ) as pct_change_in_monthly_revenue,\n        round(avg(total_monthly_revenue) over (order by order_month rows between 2 preceding and current row), 2) as rolling_avg_revenue_3mo,\n        round(avg(total_items_ordered_monthly) over (order by order_month rows between 2 preceding and current row), 2) as rolling_avg_items_sold_3mo\n    from combined\n)\n\nselect *\nfrom final\norder by order_month desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.218559Z", "completed_at": "2025-05-17T21:25:27.236577Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.238577Z", "completed_at": "2025-05-17T21:25:27.238577Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.035033464431762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_monthly_food_sales_top_monthly_food_category_name__Mains__Large_Cuts__Steaks__Cheese__Sides__Sauces__Puddings__Ice_Cream_Sorbet__Extras__Chocolates__Starters.46f9cd5b81", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        top_monthly_food_category_name as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n    group by top_monthly_food_category_name\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Mains','Large Cuts','Steaks','Cheese','Sides','Sauces','Puddings','Ice-Cream & Sorbet','Extras','Chocolates','Starters'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.223563Z", "completed_at": "2025-05-17T21:25:27.237577Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.241580Z", "completed_at": "2025-05-17T21:25:27.241580Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03803443908691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_monthly_food_sales_pct_top_food_cat_from_monthly_food_revenue__1__0.07c126e482", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_food_cat_from_monthly_food_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_food_cat_from_monthly_food_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.230570Z", "completed_at": "2025-05-17T21:25:27.238577Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.244584Z", "completed_at": "2025-05-17T21:25:27.244584Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04003572463989258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_avg_distinct_food_tables_per_day_monthly___0.b84988c81d", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(avg_distinct_food_tables_per_day_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.255593Z", "completed_at": "2025-05-17T21:25:27.272608Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.280617Z", "completed_at": "2025-05-17T21:25:27.280617Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03403043746948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_avg_food_items_per_head_monthly___0.2461b1d63c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(avg_food_items_per_head_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.261598Z", "completed_at": "2025-05-17T21:25:27.279614Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.281616Z", "completed_at": "2025-05-17T21:25:27.281616Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.034044504165649414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_avg_food_items_per_head_monthly___total_food_items_sold_monthly.477a6a2fca", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(avg_food_items_per_head_monthly <= total_food_items_sold_monthly)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.268604Z", "completed_at": "2025-05-17T21:25:27.280617Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.282617Z", "completed_at": "2025-05-17T21:25:27.282617Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03503775596618652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_avg_food_revenue_per_head_monthly___0.7ee2c7cf05", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(avg_food_revenue_per_head_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.273610Z", "completed_at": "2025-05-17T21:25:27.282617Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.287628Z", "completed_at": "2025-05-17T21:25:27.287628Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.033036231994628906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_avg_food_revenue_per_head_monthly___total_monthly_food_revenue.174e9defe0", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(avg_food_revenue_per_head_monthly <= total_monthly_food_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.299638Z", "completed_at": "2025-05-17T21:25:27.322659Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.323661Z", "completed_at": "2025-05-17T21:25:27.323661Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03403186798095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_avg_items_per_food_order_monthly___0.298cecd64a", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(avg_items_per_food_order_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.304642Z", "completed_at": "2025-05-17T21:25:27.323661Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.325662Z", "completed_at": "2025-05-17T21:25:27.325662Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603076934814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_avg_items_per_food_order_monthly___total_food_items_sold_monthly.2f74bd8c9e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(avg_items_per_food_order_monthly <= total_food_items_sold_monthly)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.309647Z", "completed_at": "2025-05-17T21:25:27.324661Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.329666Z", "completed_at": "2025-05-17T21:25:27.329666Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.038034677505493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_avg_monthly_revenue_per_food_item___0.68a278a88b", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(avg_monthly_revenue_per_food_item >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.316653Z", "completed_at": "2025-05-17T21:25:27.326663Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.332669Z", "completed_at": "2025-05-17T21:25:27.332669Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03903532028198242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_avg_monthly_revenue_per_food_item___total_monthly_food_revenue.81fdd42b50", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(avg_monthly_revenue_per_food_item <= total_monthly_food_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.343680Z", "completed_at": "2025-05-17T21:25:27.359693Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.365700Z", "completed_at": "2025-05-17T21:25:27.365700Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.031028270721435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_avg_revenue_per_food_order_monthly___0.750879b3d1", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(avg_revenue_per_food_order_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.348682Z", "completed_at": "2025-05-17T21:25:27.364697Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.366699Z", "completed_at": "2025-05-17T21:25:27.366699Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03303050994873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_avg_revenue_per_food_order_monthly___total_monthly_food_revenue.b123784a03", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(avg_revenue_per_food_order_monthly <= total_monthly_food_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.354688Z", "completed_at": "2025-05-17T21:25:27.366699Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.368701Z", "completed_at": "2025-05-17T21:25:27.368701Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.034030914306640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_food_category_diversity_monthly___0.b74e692065", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(food_category_diversity_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.360693Z", "completed_at": "2025-05-17T21:25:27.367700Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.372706Z", "completed_at": "2025-05-17T21:25:27.372706Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03603219985961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_top_monthly_food_category_revenue___0.14bcbe442c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(top_monthly_food_category_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.383714Z", "completed_at": "2025-05-17T21:25:27.400734Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.408742Z", "completed_at": "2025-05-17T21:25:27.408742Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03503537178039551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_top_monthly_food_category_revenue___total_monthly_food_revenue.c8d1ffb00c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(top_monthly_food_category_revenue <= total_monthly_food_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.389724Z", "completed_at": "2025-05-17T21:25:27.408742Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.410743Z", "completed_at": "2025-05-17T21:25:27.410743Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03503537178039551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_total_customers_monthly___0.58ca7d7d9e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(total_customers_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.395729Z", "completed_at": "2025-05-17T21:25:27.409742Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.411743Z", "completed_at": "2025-05-17T21:25:27.411743Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03803849220275879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_total_food_items_sold_monthly___0.1ff43b23e7", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(total_food_items_sold_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.400734Z", "completed_at": "2025-05-17T21:25:27.410743Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.416749Z", "completed_at": "2025-05-17T21:25:27.416749Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.040039777755737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_total_food_orders_monthly___0.844f753d49", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(total_food_orders_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.428759Z", "completed_at": "2025-05-17T21:25:27.444775Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.450780Z", "completed_at": "2025-05-17T21:25:27.450780Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03302907943725586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_total_monthly_food_revenue___0.d89576f612", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(total_monthly_food_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.434765Z", "completed_at": "2025-05-17T21:25:27.450780Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.452781Z", "completed_at": "2025-05-17T21:25:27.452781Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03303074836730957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_food_sales_unique_food_items_ordered_monthly___0.a0c517fb3e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n\nwhere not(unique_food_items_ordered_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.440770Z", "completed_at": "2025-05-17T21:25:27.451780Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.455784Z", "completed_at": "2025-05-17T21:25:27.455784Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03503084182739258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_monthly_food_sales_order_month.ba9fc09f09", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_month\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\nwhere order_month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.445775Z", "completed_at": "2025-05-17T21:25:27.455784Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.459788Z", "completed_at": "2025-05-17T21:25:27.459788Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03102850914001465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_agg_monthly_food_sales_order_month.3bf0bfe60d", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_month as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_food_sales`\n  where order_month is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.469915Z", "completed_at": "2025-05-17T21:25:27.486940Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.494943Z", "completed_at": "2025-05-17T21:25:27.494943Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.037155866622924805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.restaurant_data_analytics.agg_weekly_total_sales", "compiled": true, "compiled_code": "with food as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n),\n\ndrink as (\n    select *\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales`\n),\n\npeak_hours as (\n    select\n        f.order_week,\n        array_to_string(\n            array(\n                select distinct hour\n                from unnest(\n                    split(coalesce(f.kitchen_peak_hours_weekly, '') || ',' || coalesce(d.bar_peak_hours_weekly, ''), ',')\n                ) as hour\n                where safe_cast(hour as int) is not null\n                order by cast(hour as int)\n            ), ','\n        ) as peak_hours_weekly\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales` f\n    join `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_drink_sales` d using (order_week)\n),\n\ncombined as (\n    select\n        f.order_week,\n        f.week_start_date,\n        f.week_end_date,\n\n        f.total_food_items_sold_weekly + d.total_drink_items_sold_weekly as total_items_ordered_weekly,\n        f.total_weekly_food_revenue + d.total_weekly_drink_revenue as total_weekly_revenue,\n        round(\n            (f.total_weekly_food_revenue + d.total_weekly_drink_revenue) /\n            nullif(f.total_food_items_sold_weekly + d.total_drink_items_sold_weekly, 0),\n            2\n        ) as avg_revenue_per_item_weekly,\n\n        f.food_category_diversity_weekly + d.drink_category_diversity_weekly as category_diversity_weekly,\n\n        case\n            when f.top_weekly_food_category_revenue >= d.top_weekly_drink_category_revenue\n                then f.top_weekly_food_category_name\n            else d.top_weekly_drink_category_name\n        end as top_weekly_category_name,\n\n        greatest(f.top_weekly_food_category_revenue, d.top_weekly_drink_category_revenue) as top_weekly_category_revenue,\n\n        round(f.total_weekly_food_revenue / nullif(f.total_weekly_food_revenue + d.total_weekly_drink_revenue, 0), 2) as pct_food_from_weekly_revenue,\n        round(d.total_weekly_drink_revenue / nullif(f.total_weekly_food_revenue + d.total_weekly_drink_revenue, 0), 2) as pct_drink_from_weekly_revenue,\n        round(\n            greatest(f.top_weekly_food_category_revenue, d.top_weekly_drink_category_revenue) /\n            nullif(f.total_weekly_food_revenue + d.total_weekly_drink_revenue, 0),\n            2\n        ) as pct_top_cat_of_total_weekly_revenue,\n\n        f.total_customers_weekly as total_weekly_customers,\n        round((f.total_weekly_food_revenue + d.total_weekly_drink_revenue) / nullif(f.total_customers_weekly, 0), 2) as avg_weekly_revenue_per_head,\n        round((f.total_food_items_sold_weekly + d.total_drink_items_sold_weekly) / nullif(f.total_customers_weekly, 0), 2) as avg_items_ordered_per_head_weekly,\n\n        f.total_food_orders_weekly + d.total_drink_orders_weekly as total_orders_weekly,\n        round((f.total_food_items_sold_weekly + d.total_drink_items_sold_weekly) / nullif((f.total_food_orders_weekly + d.total_drink_orders_weekly), 0), 2) as avg_items_per_order_weekly,\n        round((f.total_weekly_food_revenue + d.total_weekly_drink_revenue) / nullif((f.total_food_orders_weekly + d.total_drink_orders_weekly), 0), 2) as avg_revenue_per_order_weekly,\n\n        f.unique_food_items_ordered_weekly + d.unique_drink_items_ordered_weekly as unique_items_ordered_weekly,\n\n        round((f.avg_distinct_food_tables_per_day_weekly + d.avg_distinct_drink_tables_per_day_weekly) / 2, 2) as avg_distinct_tables_per_day_weekly\n\n    from food f\n    join drink d using (order_week)\n),\n\nweekly_totals as (\n    select c.*,\n        p.peak_hours_weekly\n    from combined c\n    left join peak_hours p using (order_week)\n),\n\nrevenue_trends as (\n    select\n        *,\n        round((total_weekly_revenue - lag(total_weekly_revenue) over (order by order_week)), 2) as weekly_revenue_change_amount,\n        round((total_weekly_revenue - lag(total_weekly_revenue) over (order by order_week)) / nullif(lag(total_weekly_revenue) over (order by order_week), 0), 4) as pct_change_in_weekly_revenue,\n        round(avg(total_weekly_revenue) over (order by order_week rows between 3 preceding and current row), 2) as rolling_avg_revenue_4wk,\n        round(avg(total_items_ordered_weekly) over (order by order_week rows between 3 preceding and current row), 2) as rolling_avg_items_sold_4wk\n    from weekly_totals\n)\n\nselect *\nfrom revenue_trends\norder by order_week desc", "relation_name": "`annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.475922Z", "completed_at": "2025-05-17T21:25:27.493941Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.495943Z", "completed_at": "2025-05-17T21:25:27.495943Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.035155296325683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.accepted_values_agg_weekly_food_sales_top_weekly_food_category_name__Mains__Large_Cuts__Steaks__Cheese__Sides__Sauces__Puddings__Ice_Cream_Sorbet__Extras__Chocolates__Starters.64b09e1561", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        top_weekly_food_category_name as value_field,\n        count(*) as n_records\n\n    from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n    group by top_weekly_food_category_name\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Mains','Large Cuts','Steaks','Cheese','Sides','Sauces','Puddings','Ice-Cream & Sorbet','Extras','Chocolates','Starters'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.481926Z", "completed_at": "2025-05-17T21:25:27.495943Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.497944Z", "completed_at": "2025-05-17T21:25:27.497944Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.036154747009277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_weekly_food_sales_pct_top_food_cat_from_weekly_food_revenue__1__0.365a4895df", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_food_cat_from_weekly_food_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_food_cat_from_weekly_food_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.487935Z", "completed_at": "2025-05-17T21:25:27.496944Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.501949Z", "completed_at": "2025-05-17T21:25:27.501949Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.033033132553100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_avg_distinct_food_tables_per_day_weekly___0.c84314490e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(avg_distinct_food_tables_per_day_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.514960Z", "completed_at": "2025-05-17T21:25:27.537981Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.538983Z", "completed_at": "2025-05-17T21:25:27.538983Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03302741050720215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_avg_food_items_per_head_weekly___0.1d347bf445", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(avg_food_items_per_head_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.519964Z", "completed_at": "2025-05-17T21:25:27.537981Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.539983Z", "completed_at": "2025-05-17T21:25:27.539983Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603243827819824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_avg_food_items_per_head_weekly___total_food_items_sold_weekly.318280b408", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(avg_food_items_per_head_weekly <= total_food_items_sold_weekly)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.526970Z", "completed_at": "2025-05-17T21:25:27.539983Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.543987Z", "completed_at": "2025-05-17T21:25:27.543987Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03703498840332031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_avg_food_revenue_per_head_weekly___0.50fa490211", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(avg_food_revenue_per_head_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.531976Z", "completed_at": "2025-05-17T21:25:27.540985Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.544988Z", "completed_at": "2025-05-17T21:25:27.544988Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.038034915924072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_avg_food_revenue_per_head_weekly___total_weekly_food_revenue.e067f7bbb2", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(avg_food_revenue_per_head_weekly <= total_weekly_food_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.557999Z", "completed_at": "2025-05-17T21:25:27.574013Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.583022Z", "completed_at": "2025-05-17T21:25:27.583022Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0340421199798584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_avg_items_per_food_order_weekly___0.0c61762bec", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(avg_items_per_food_order_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.564005Z", "completed_at": "2025-05-17T21:25:27.582020Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.584024Z", "completed_at": "2025-05-17T21:25:27.584024Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03503704071044922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_avg_items_per_food_order_weekly___total_food_items_sold_weekly.e2850116ab", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(avg_items_per_food_order_weekly <= total_food_items_sold_weekly)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.569009Z", "completed_at": "2025-05-17T21:25:27.583022Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.586025Z", "completed_at": "2025-05-17T21:25:27.586025Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03603768348693848, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_avg_revenue_per_food_order_weekly___0.0132a4f6c4", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(avg_revenue_per_food_order_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.575014Z", "completed_at": "2025-05-17T21:25:27.585025Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.590033Z", "completed_at": "2025-05-17T21:25:27.590033Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03803896903991699, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_avg_revenue_per_food_order_weekly___total_weekly_food_revenue.ca3cb0a3a7", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(avg_revenue_per_food_order_weekly <= total_weekly_food_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.601042Z", "completed_at": "2025-05-17T21:25:27.622061Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.624065Z", "completed_at": "2025-05-17T21:25:27.624065Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.032030344009399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_avg_weekly_revenue_per_food_item___0.2c5a59df89", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(avg_weekly_revenue_per_food_item >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.606046Z", "completed_at": "2025-05-17T21:25:27.623062Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.626065Z", "completed_at": "2025-05-17T21:25:27.626065Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.035033226013183594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_food_category_diversity_weekly___0.edb6aeaed1", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(food_category_diversity_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.612053Z", "completed_at": "2025-05-17T21:25:27.624065Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.626065Z", "completed_at": "2025-05-17T21:25:27.626065Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03503227233886719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_top_weekly_food_category_revenue___0.d706ee86c0", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(top_weekly_food_category_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.617056Z", "completed_at": "2025-05-17T21:25:27.625064Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.627067Z", "completed_at": "2025-05-17T21:25:27.627067Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.036032915115356445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_top_weekly_food_category_revenue___total_weekly_food_revenue.40453a3f2f", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(top_weekly_food_category_revenue <= total_weekly_food_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.643081Z", "completed_at": "2025-05-17T21:25:27.664099Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.666103Z", "completed_at": "2025-05-17T21:25:27.666103Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.030026674270629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_total_customers_weekly___0.b00ced16e6", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(total_customers_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.649087Z", "completed_at": "2025-05-17T21:25:27.665101Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.667103Z", "completed_at": "2025-05-17T21:25:27.667103Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03303027153015137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_total_food_items_sold_weekly___0.d5463b5b57", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(total_food_items_sold_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.654092Z", "completed_at": "2025-05-17T21:25:27.666103Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.670105Z", "completed_at": "2025-05-17T21:25:27.670105Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03503084182739258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_total_food_orders_weekly___0.58a3404295", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(total_food_orders_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.659095Z", "completed_at": "2025-05-17T21:25:27.667103Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.673109Z", "completed_at": "2025-05-17T21:25:27.673109Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03903555870056152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_total_weekly_food_revenue___0.d283f147f3", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(total_weekly_food_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.685120Z", "completed_at": "2025-05-17T21:25:27.790944Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.797952Z", "completed_at": "2025-05-17T21:25:27.797952Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.12083959579467773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_food_sales_unique_food_items_ordered_weekly___0.290f16a81a", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n\nwhere not(unique_food_items_ordered_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.781211Z", "completed_at": "2025-05-17T21:25:27.796950Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.798953Z", "completed_at": "2025-05-17T21:25:27.798953Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1218421459197998, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_weekly_food_sales_order_week.25a819365a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_week\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\nwhere order_week is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.786214Z", "completed_at": "2025-05-17T21:25:27.797952Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.800954Z", "completed_at": "2025-05-17T21:25:27.800954Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.12284231185913086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_agg_weekly_food_sales_order_week.f274cc1360", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_week as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_food_sales`\n  where order_week is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.791945Z", "completed_at": "2025-05-17T21:25:27.799953Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.804959Z", "completed_at": "2025-05-17T21:25:27.804959Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12584257125854492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_monthly_total_sales_pct_drink_from_monthly_revenue__1__0.878750343a", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_drink_from_monthly_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_drink_from_monthly_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.814966Z", "completed_at": "2025-05-17T21:25:27.832983Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.839989Z", "completed_at": "2025-05-17T21:25:27.839989Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03603243827819824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_monthly_total_sales_pct_food_from_monthly_revenue__1__0.23ed9482de", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_food_from_monthly_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_food_from_monthly_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.821974Z", "completed_at": "2025-05-17T21:25:27.839989Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.841992Z", "completed_at": "2025-05-17T21:25:27.841992Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603386878967285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_monthly_total_sales_pct_top_cat_of_total_monthly_revenue__1__0.2218cb4677", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_cat_of_total_monthly_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_cat_of_total_monthly_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.827979Z", "completed_at": "2025-05-17T21:25:27.840991Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.842992Z", "completed_at": "2025-05-17T21:25:27.842992Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.036032915115356445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_avg_distinct_tables_per_day_monthly___0.f0590f7000", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(avg_distinct_tables_per_day_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.833985Z", "completed_at": "2025-05-17T21:25:27.841992Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.847998Z", "completed_at": "2025-05-17T21:25:27.847998Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03403019905090332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_avg_items_ordered_per_head_monthly___0.e1cfa72b9c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(avg_items_ordered_per_head_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.860007Z", "completed_at": "2025-05-17T21:25:27.883028Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.885030Z", "completed_at": "2025-05-17T21:25:27.885030Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03360438346862793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_avg_items_ordered_per_head_monthly___total_items_ordered_monthly.a1e1950805", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(avg_items_ordered_per_head_monthly <= total_items_ordered_monthly)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.867014Z", "completed_at": "2025-05-17T21:25:27.884029Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.885030Z", "completed_at": "2025-05-17T21:25:27.885030Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.034604787826538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_avg_items_per_order_monthly___1.9c95b67c0e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(avg_items_per_order_monthly >= 1)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.873020Z", "completed_at": "2025-05-17T21:25:27.886031Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.891610Z", "completed_at": "2025-05-17T21:25:27.891610Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03860759735107422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_avg_items_per_order_monthly___total_items_ordered_monthly.9838ff2afb", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(avg_items_per_order_monthly <= total_items_ordered_monthly)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.878025Z", "completed_at": "2025-05-17T21:25:27.886608Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.892609Z", "completed_at": "2025-05-17T21:25:27.892609Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.038605451583862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_avg_monthly_revenue_per_head___0.446f45d0be", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(avg_monthly_revenue_per_head >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.903619Z", "completed_at": "2025-05-17T21:25:27.920635Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.926641Z", "completed_at": "2025-05-17T21:25:27.927642Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03303027153015137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_avg_monthly_revenue_per_head___total_monthly_revenue.8bef2fada4", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(avg_monthly_revenue_per_head <= total_monthly_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.909626Z", "completed_at": "2025-05-17T21:25:27.926641Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.928642Z", "completed_at": "2025-05-17T21:25:27.928642Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03403186798095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_avg_revenue_per_item_monthly___0.4811754c19", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(avg_revenue_per_item_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.915631Z", "completed_at": "2025-05-17T21:25:27.927642Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.929643Z", "completed_at": "2025-05-17T21:25:27.929643Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03402996063232422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_avg_revenue_per_item_monthly___total_monthly_revenue.5a8878dc6b", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(avg_revenue_per_item_monthly <= total_monthly_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.921637Z", "completed_at": "2025-05-17T21:25:27.928642Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.934649Z", "completed_at": "2025-05-17T21:25:27.934649Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0370328426361084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_avg_revenue_per_order_monthly___0.f7303eda9e", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(avg_revenue_per_order_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.944658Z", "completed_at": "2025-05-17T21:25:27.963674Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.970682Z", "completed_at": "2025-05-17T21:25:27.970682Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03603386878967285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_avg_revenue_per_order_monthly___total_monthly_revenue.7b2f552b61", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(avg_revenue_per_order_monthly <= total_monthly_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.953666Z", "completed_at": "2025-05-17T21:25:27.969680Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.971681Z", "completed_at": "2025-05-17T21:25:27.971681Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.036032676696777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_category_diversity_monthly___0.c1414dac5f", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(category_diversity_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.958670Z", "completed_at": "2025-05-17T21:25:27.970682Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.975685Z", "completed_at": "2025-05-17T21:25:27.975685Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0370335578918457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_rolling_avg_items_sold_3mo___0.9ea6bec03b", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(rolling_avg_items_sold_3mo >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.964676Z", "completed_at": "2025-05-17T21:25:27.972682Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:27.975685Z", "completed_at": "2025-05-17T21:25:27.975685Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03203010559082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_rolling_avg_revenue_3mo___0.e9be1783bc", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(rolling_avg_revenue_3mo >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.988698Z", "completed_at": "2025-05-17T21:25:28.005712Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.011719Z", "completed_at": "2025-05-17T21:25:28.011719Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.033029794692993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_top_monthly_category_revenue___0.bf12b281dc", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(top_monthly_category_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:27.994703Z", "completed_at": "2025-05-17T21:25:28.011719Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.013720Z", "completed_at": "2025-05-17T21:25:28.013720Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03303027153015137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_top_monthly_category_revenue___total_monthly_revenue.43f14c9bbd", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(top_monthly_category_revenue <= total_monthly_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.000708Z", "completed_at": "2025-05-17T21:25:28.012719Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.014721Z", "completed_at": "2025-05-17T21:25:28.014721Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03503227233886719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_total_items_ordered_monthly___0.a682889021", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(total_items_ordered_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.005712Z", "completed_at": "2025-05-17T21:25:28.013720Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.019725Z", "completed_at": "2025-05-17T21:25:28.019725Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03803372383117676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_total_monthly_customers___0.e29c7f5803", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(total_monthly_customers >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.032738Z", "completed_at": "2025-05-17T21:25:28.056758Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.058760Z", "completed_at": "2025-05-17T21:25:28.058760Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03503131866455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_total_monthly_revenue___0.99855eb949", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(total_monthly_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.037742Z", "completed_at": "2025-05-17T21:25:28.056758Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.058760Z", "completed_at": "2025-05-17T21:25:28.058760Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603339195251465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_total_orders_monthly___0.dcfb1f4451", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(total_orders_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.045750Z", "completed_at": "2025-05-17T21:25:28.057760Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.059762Z", "completed_at": "2025-05-17T21:25:28.059762Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.038034677505493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_unique_items_ordered_monthly___0.f9b73669ce", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(unique_items_ordered_monthly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.051756Z", "completed_at": "2025-05-17T21:25:28.059762Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.064767Z", "completed_at": "2025-05-17T21:25:28.064767Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03903460502624512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_monthly_total_sales_weekend_days_in_month___0.562dbe12a0", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n\nwhere not(weekend_days_in_month >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.076777Z", "completed_at": "2025-05-17T21:25:28.096795Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.098798Z", "completed_at": "2025-05-17T21:25:28.098798Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.030028343200683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_monthly_total_sales_order_month.4a7866b528", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_month\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\nwhere order_month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.081783Z", "completed_at": "2025-05-17T21:25:28.097797Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.099799Z", "completed_at": "2025-05-17T21:25:28.099799Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.032030582427978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_agg_monthly_total_sales_order_month.3393fa5406", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_month as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_monthly_total_sales`\n  where order_month is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.086786Z", "completed_at": "2025-05-17T21:25:28.098798Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.102801Z", "completed_at": "2025-05-17T21:25:28.102801Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03403186798095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_weekly_total_sales_pct_drink_from_weekly_revenue__1__0.5e0fb563eb", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_drink_from_weekly_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_drink_from_weekly_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.091791Z", "completed_at": "2025-05-17T21:25:28.099799Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.105805Z", "completed_at": "2025-05-17T21:25:28.105805Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03603172302246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_weekly_total_sales_pct_food_from_weekly_revenue__1__0.820b22ed71", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_food_from_weekly_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_food_from_weekly_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.116814Z", "completed_at": "2025-05-17T21:25:28.134922Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.142929Z", "completed_at": "2025-05-17T21:25:28.142929Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03612351417541504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_accepted_range_agg_weekly_total_sales_pct_top_cat_of_total_weekly_revenue__1__0.03791cbfec", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_cat_of_total_weekly_revenue >= 0\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not pct_top_cat_of_total_weekly_revenue <= 1\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.122911Z", "completed_at": "2025-05-17T21:25:28.141928Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.143931Z", "completed_at": "2025-05-17T21:25:28.143931Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0351254940032959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_avg_distinct_tables_per_day_weekly___0.960810e9aa", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(avg_distinct_tables_per_day_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.129917Z", "completed_at": "2025-05-17T21:25:28.143931Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.145932Z", "completed_at": "2025-05-17T21:25:28.145932Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0371251106262207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_avg_items_ordered_per_head_weekly___0.07d5dbcd47", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(avg_items_ordered_per_head_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.135922Z", "completed_at": "2025-05-17T21:25:28.144932Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.149937Z", "completed_at": "2025-05-17T21:25:28.149937Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03303050994873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_avg_items_ordered_per_head_weekly___total_items_ordered_weekly.b2b0a0e409", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(avg_items_ordered_per_head_weekly <= total_items_ordered_weekly)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.161947Z", "completed_at": "2025-05-17T21:25:28.182965Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.183967Z", "completed_at": "2025-05-17T21:25:28.184967Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03102898597717285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_avg_items_per_order_weekly___0.c79e705419", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(avg_items_per_order_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.166951Z", "completed_at": "2025-05-17T21:25:28.183967Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.185969Z", "completed_at": "2025-05-17T21:25:28.185969Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.035033226013183594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_avg_items_per_order_weekly___total_items_ordered_weekly.d9cd7feced", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(avg_items_per_order_weekly <= total_items_ordered_weekly)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.171956Z", "completed_at": "2025-05-17T21:25:28.184967Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.188972Z", "completed_at": "2025-05-17T21:25:28.188972Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.036031484603881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_avg_revenue_per_item_weekly___0.ae9684cdd7", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(avg_revenue_per_item_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.177961Z", "completed_at": "2025-05-17T21:25:28.185969Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.189972Z", "completed_at": "2025-05-17T21:25:28.189972Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.037032365798950195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_avg_revenue_per_order_weekly___0.5379b62377", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(avg_revenue_per_order_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.202985Z", "completed_at": "2025-05-17T21:25:28.227006Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.228007Z", "completed_at": "2025-05-17T21:25:28.228007Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03403115272521973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_avg_revenue_per_order_weekly___total_weekly_revenue.df8ba52941", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(avg_revenue_per_order_weekly <= total_weekly_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.209991Z", "completed_at": "2025-05-17T21:25:28.229008Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.233011Z", "completed_at": "2025-05-17T21:25:28.233011Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03703427314758301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_avg_weekly_revenue_per_head___0.587120d32c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(avg_weekly_revenue_per_head >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.214995Z", "completed_at": "2025-05-17T21:25:28.230008Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.234012Z", "completed_at": "2025-05-17T21:25:28.234012Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.038033485412597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_avg_weekly_revenue_per_head___total_weekly_revenue.42e91454f3", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(avg_weekly_revenue_per_head <= total_weekly_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.222001Z", "completed_at": "2025-05-17T21:25:28.231009Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.234012Z", "completed_at": "2025-05-17T21:25:28.234012Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.039035797119140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_category_diversity_weekly___0.6c9a732c42", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(category_diversity_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.247024Z", "completed_at": "2025-05-17T21:25:28.264039Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.270046Z", "completed_at": "2025-05-17T21:25:28.270046Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03102850914001465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_rolling_avg_items_sold_4wk___0.cedc5b3664", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(rolling_avg_items_sold_4wk >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.254032Z", "completed_at": "2025-05-17T21:25:28.271047Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.274048Z", "completed_at": "2025-05-17T21:25:28.274048Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.034032583236694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_rolling_avg_revenue_4wk___0.9537536a2c", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(rolling_avg_revenue_4wk >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.259036Z", "completed_at": "2025-05-17T21:25:28.271047Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.276050Z", "completed_at": "2025-05-17T21:25:28.276050Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03503131866455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_top_weekly_category_revenue___0.dc832bb5be", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(top_weekly_category_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.265040Z", "completed_at": "2025-05-17T21:25:28.275049Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.279055Z", "completed_at": "2025-05-17T21:25:28.279055Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.038034677505493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_top_weekly_category_revenue___total_weekly_revenue.ccb45074c3", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(top_weekly_category_revenue <= total_weekly_revenue)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.288061Z", "completed_at": "2025-05-17T21:25:28.301073Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.314085Z", "completed_at": "2025-05-17T21:25:28.314085Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03603196144104004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_total_items_ordered_weekly___0.73155e1e88", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(total_items_ordered_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.296068Z", "completed_at": "2025-05-17T21:25:28.314085Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.319090Z", "completed_at": "2025-05-17T21:25:28.319090Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03603386878967285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_total_orders_weekly___0.5ae1a4f6b8", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(total_orders_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.302075Z", "completed_at": "2025-05-17T21:25:28.317087Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.319090Z", "completed_at": "2025-05-17T21:25:28.319090Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.037033796310424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_total_weekly_customers___0.b0b75fd34a", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(total_weekly_customers >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.309081Z", "completed_at": "2025-05-17T21:25:28.318088Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.321091Z", "completed_at": "2025-05-17T21:25:28.321091Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03403043746948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_total_weekly_revenue___0.ce7b641f73", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(total_weekly_revenue >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.332103Z", "completed_at": "2025-05-17T21:25:28.348116Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.349118Z", "completed_at": "2025-05-17T21:25:28.349118Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.027024030685424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.dbt_utils_expression_is_true_agg_weekly_total_sales_unique_items_ordered_weekly___0.ae03e2fda3", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n\nwhere not(unique_items_ordered_weekly >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.339108Z", "completed_at": "2025-05-17T21:25:28.349118Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.351120Z", "completed_at": "2025-05-17T21:25:28.351120Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.024023056030273438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.not_null_agg_weekly_total_sales_order_week.cdd5ee8945", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_week\nfrom `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\nwhere order_week is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-17T21:25:28.344112Z", "completed_at": "2025-05-17T21:25:28.350119Z"}, {"name": "execute", "started_at": "2025-05-17T21:25:28.353120Z", "completed_at": "2025-05-17T21:25:28.353120Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026022672653198242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.restaurant_data_analytics.unique_agg_weekly_total_sales_order_week.219fbdfbf9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_week as unique_field\n  from `annular-mesh-453913-r6`.`dbt_`.`agg_weekly_total_sales`\n  where order_week is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 4.7105584144592285, "args": {"strict_mode": false, "log_path": "C:\\Users\\alexv\\git\\restaurant-data-analytics\\logs", "select": [], "profiles_dir": "C:\\Users\\alexv\\.dbt", "project_dir": "C:\\Users\\alexv\\git\\restaurant-data-analytics", "state_modified_compare_vars": false, "log_file_max_bytes": 10485760, "vars": {}, "require_resource_names_without_spaces": false, "introspect": true, "static": false, "empty_catalog": false, "populate_cache": true, "require_batched_execution_for_custom_microbatch_strategy": false, "static_parser": true, "require_yaml_configuration_for_mf_time_spines": false, "printer_width": 80, "show_resource_report": false, "state_modified_compare_more_unrendered_values": false, "version_check": true, "require_nested_cumulative_type_params": false, "cache_selected_only": false, "quiet": false, "use_colors_file": true, "indirect_selection": "eager", "source_freshness_run_project_hooks": false, "which": "generate", "exclude": [], "favor_state": false, "defer": false, "partial_parse": true, "log_format_file": "debug", "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse_file_diff": true, "skip_nodes_if_on_run_start_fails": false, "invocation_command": "dbt docs generate", "write_json": true, "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "use_colors": true, "compile": true, "log_format": "default", "macro_debugging": false, "log_level": "info", "send_anonymous_usage_stats": true}}